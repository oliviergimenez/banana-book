<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Bayesian analysis of capture-recapture data with hidden Markov models</title>

    <meta name="author" content="Olivier Gimenez" />
  
   <meta name="description" content="This is a textbook on the analysis of capture-recapture data with hidden Markov models (HMM) implemented in the Bayesian framework with R and NIMBLE." />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="Bayesian analysis of capture-recapture data with hidden Markov models" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="<a href="https://oliviergimenez.github.io/banana-book/" class="uri">https://oliviergimenez.github.io/banana-book/</a>" />
  
  <meta property="og:description" content="This is a textbook on the analysis of capture-recapture data with hidden Markov models (HMM) implemented in the Bayesian framework with R and NIMBLE." />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Bayesian analysis of capture-recapture data with hidden Markov models" />
  
  <meta name="twitter:description" content="This is a textbook on the analysis of capture-recapture data with hidden Markov models (HMM) implemented in the Bayesian framework with R and NIMBLE." />
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.9.0/transition.js"></script>
    <script src="libs/bs3compat-0.9.0/tabs.js"></script>
    <script src="libs/bs3compat-0.9.0/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
  <style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
      <link rel="stylesheet" href="bs4_style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<!--bookdown:title:start-->
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Theory and case studies in R and NIMBLE">Bayesian analysis of capture-recapture data with hidden Markov models</a>:
        <small class="text-muted">Theory and case studies in R and NIMBLE</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="warning-package-pgfplots-warning-running-in-backwards-compatibility-mode-unsuitable-tick-labels-missing-features.-consider-writing-into-your-preamble." class="section level1" number="1">
<h1><span class="header-section-number">1</span> Warning: Package pgfplots Warning: running in backwards compatibility mode (unsuitable tick labels; missing features). Consider writing into your preamble.</h1>
<p>Placeholder</p>
<div id="license" class="section level2 unnumbered">
<h2 class="unnumbered">License</h2>
<!--chapter:end:index.Rmd-->
</div>
</div>
<div id="preface" class="section level1 unnumbered">
<h1 class="unnumbered">Preface</h1>
<p>Placeholder</p>
<div id="why-this-book" class="section level2 unnumbered">
<h2 class="unnumbered">Why this book?</h2>
</div>
<div id="who-should-read-this-book" class="section level2 unnumbered">
<h2 class="unnumbered">Who should read this book?</h2>
</div>
<div id="what-will-you-learn" class="section level2 unnumbered">
<h2 class="unnumbered">What will you learn?</h2>
</div>
<div id="what-wont-you-learn" class="section level2 unnumbered">
<h2 class="unnumbered">What won’t you learn?</h2>
</div>
<div id="prerequisites" class="section level2 unnumbered">
<h2 class="unnumbered">Prerequisites</h2>
</div>
<div id="how-this-book-was-written" class="section level2 unnumbered">
<h2 class="unnumbered">How this book was written</h2>
</div>
<div id="about-the-author" class="section level2 unnumbered">
<h2 class="unnumbered">About the author</h2>
</div>
<div id="acknowledgements" class="section level2 unnumbered">
<h2 class="unnumbered">Acknowledgements</h2>
<!--chapter:end:0-preface.Rmd-->
</div>
</div>
<div id="part-foundations" class="section level1 unnumbered">
<h1 class="unnumbered">(PART) Foundations</h1>
</div>
<div id="introduction" class="section level1 unnumbered">
<h1 class="unnumbered">Introduction</h1>
<p>WORK IN PROGRESS</p>
<p>This first part <code>Foundations</code> is aimed at getting you up-to-speed with Bayesian statistics, NIMBLE, and hidden Markov models.</p>
<!--chapter:end:introductionpartone.Rmd-->
</div>
<div id="crashcourse" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Bayesian statistics &amp; MCMC</h1>
<p>Placeholder</p>
<div id="introduction-1" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Introduction</h2>
</div>
<div id="bayes-theorem" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Bayes’ theorem</h2>
</div>
<div id="what-is-the-bayesian-approach" class="section level2" number="2.3">
<h2><span class="header-section-number">2.3</span> What is the Bayesian approach?</h2>
</div>
<div id="numerical-approx" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Approximating posteriors via numerical integration</h2>
</div>
<div id="markov-chain-monte-carlo-mcmc" class="section level2" number="2.5">
<h2><span class="header-section-number">2.5</span> Markov chain Monte Carlo (MCMC)</h2>
<div id="monte-carlo-integration" class="section level3" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> Monte Carlo integration</h3>
</div>
<div id="markovmodelmcmc" class="section level3" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> Markov chains</h3>
</div>
<div id="metropolis-algorithm" class="section level3" number="2.5.3">
<h3><span class="header-section-number">2.5.3</span> Metropolis algorithm</h3>
</div>
</div>
<div id="convergence-diag" class="section level2" number="2.6">
<h2><span class="header-section-number">2.6</span> Assessing convergence</h2>
<div id="burn-in" class="section level3" number="2.6.1">
<h3><span class="header-section-number">2.6.1</span> Burn-in</h3>
</div>
<div id="chain-length" class="section level3" number="2.6.2">
<h3><span class="header-section-number">2.6.2</span> Chain length</h3>
</div>
<div id="what-if-you-have-issues-of-convergence" class="section level3" number="2.6.3">
<h3><span class="header-section-number">2.6.3</span> What if you have issues of convergence?</h3>
</div>
</div>
<div id="summary" class="section level2" number="2.7">
<h2><span class="header-section-number">2.7</span> Summary</h2>
</div>
<div id="suggested-reading" class="section level2" number="2.8">
<h2><span class="header-section-number">2.8</span> Suggested reading</h2>
<!--chapter:end:1-bayesmcmc.Rmd-->
</div>
</div>
<div id="intronimble" class="section level1" number="3">
<h1><span class="header-section-number">3</span> NIMBLE tutorial</h1>
<p>Placeholder</p>
<div id="introduction-2" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Introduction</h2>
</div>
<div id="what-is-nimble" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> What is NIMBLE?</h2>
</div>
<div id="start-nimble" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Getting started</h2>
</div>
<div id="functions-in-nimble" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Programming</h2>
<div id="nimble-functions" class="section level3" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> NIMBLE functions</h3>
</div>
<div id="callrfninnimble" class="section level3" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Calling R/C++ functions</h3>
</div>
<div id="user-defined-distributions" class="section level3" number="3.4.3">
<h3><span class="header-section-number">3.4.3</span> User-defined distributions</h3>
</div>
</div>
<div id="under-the-hood" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Under the hood</h2>
</div>
<div id="mcmc-samplers" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> MCMC samplers</h2>
<div id="change-sampler" class="section level3" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> Default samplers</h3>
</div>
<div id="user-defined-samplers" class="section level3" number="3.6.2">
<h3><span class="header-section-number">3.6.2</span> User-defined samplers</h3>
</div>
</div>
<div id="tips-and-tricks" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Tips and tricks</h2>
<div id="precision-vs-standard-deviation" class="section level3" number="3.7.1">
<h3><span class="header-section-number">3.7.1</span> Precision vs standard deviation</h3>
</div>
<div id="indexing" class="section level3" number="3.7.2">
<h3><span class="header-section-number">3.7.2</span> Indexing</h3>
</div>
<div id="faster-compilation" class="section level3" number="3.7.3">
<h3><span class="header-section-number">3.7.3</span> Faster compilation</h3>
</div>
<div id="updating-mcmc-chains" class="section level3" number="3.7.4">
<h3><span class="header-section-number">3.7.4</span> Updating MCMC chains</h3>
</div>
<div id="tipreproducibility" class="section level3" number="3.7.5">
<h3><span class="header-section-number">3.7.5</span> Reproducibility</h3>
</div>
<div id="parallelization" class="section level3" number="3.7.6">
<h3><span class="header-section-number">3.7.6</span> Parallelization</h3>
</div>
<div id="incomplete-and-incorrect-initialization" class="section level3" number="3.7.7">
<h3><span class="header-section-number">3.7.7</span> Incomplete and incorrect initialization</h3>
</div>
<div id="vectorization" class="section level3" number="3.7.8">
<h3><span class="header-section-number">3.7.8</span> Vectorization</h3>
</div>
</div>
<div id="summary-1" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Summary</h2>
</div>
<div id="suggested-reading-1" class="section level2" number="3.9">
<h2><span class="header-section-number">3.9</span> Suggested reading</h2>
<!--chapter:end:2-nimble.Rmd-->
</div>
</div>
<div id="hmmcapturerecapture" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Hidden Markov models</h1>
<p>Placeholder</p>
<div id="introduction-3" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Introduction</h2>
</div>
<div id="longitudinal-data" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Longitudinal data</h2>
</div>
<div id="a-markov-model-for-longitudinal-data" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> A Markov model for longitudinal data</h2>
<div id="assumptions" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Assumptions</h3>
</div>
<div id="transition-matrix" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Transition matrix</h3>
</div>
<div id="initial-states" class="section level3" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Initial states</h3>
</div>
<div id="likelihood" class="section level3" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Likelihood</h3>
</div>
<div id="example" class="section level3" number="4.3.5">
<h3><span class="header-section-number">4.3.5</span> Example</h3>
</div>
</div>
<div id="bayesian-formulation" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Bayesian formulation</h2>
</div>
<div id="nimble-implementation" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> NIMBLE implementation</h2>
</div>
<div id="hidden-markov-models" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Hidden Markov models</h2>
<div id="capturerecapturedata" class="section level3" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Capture-recapture data</h3>
</div>
<div id="observation-matrix" class="section level3" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> Observation matrix</h3>
</div>
<div id="hidden-markov-model" class="section level3" number="4.6.3">
<h3><span class="header-section-number">4.6.3</span> Hidden Markov model</h3>
</div>
<div id="likelihoodhmm" class="section level3" number="4.6.4">
<h3><span class="header-section-number">4.6.4</span> Likelihood</h3>
</div>
</div>
<div id="fittinghmmnimble" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Fitting HMM with NIMBLE</h2>
</div>
<div id="marginalization" class="section level2" number="4.8">
<h2><span class="header-section-number">4.8</span> Marginalization</h2>
<div id="brute-force-approach" class="section level3" number="4.8.1">
<h3><span class="header-section-number">4.8.1</span> Brute-force approach</h3>
</div>
<div id="forward-algorithm" class="section level3" number="4.8.2">
<h3><span class="header-section-number">4.8.2</span> Forward algorithm</h3>
</div>
<div id="nimblemarginalization" class="section level3" number="4.8.3">
<h3><span class="header-section-number">4.8.3</span> NIMBLE implementation</h3>
<div id="diymarginalisation" class="section level4" number="4.8.3.1">
<h4><span class="header-section-number">4.8.3.1</span> Do it yourself</h4>
</div>
<div id="do-it-with-nimbleecology" class="section level4" number="4.8.3.2">
<h4><span class="header-section-number">4.8.3.2</span> Do it with <code>nimbleEcology</code></h4>
</div>
</div>
</div>
<div id="pooled-likelihood" class="section level2" number="4.9">
<h2><span class="header-section-number">4.9</span> Pooled encounter histories</h2>
</div>
<div id="decoding" class="section level2" number="4.10">
<h2><span class="header-section-number">4.10</span> Decoding after marginalization</h2>
<div id="viterbi-theory" class="section level3" number="4.10.1">
<h3><span class="header-section-number">4.10.1</span> Theory</h3>
</div>
<div id="implementation" class="section level3" number="4.10.2">
<h3><span class="header-section-number">4.10.2</span> Implementation</h3>
</div>
<div id="compute-average" class="section level3" number="4.10.3">
<h3><span class="header-section-number">4.10.3</span> Compute first, average after</h3>
</div>
<div id="average-first-compute-after" class="section level3" number="4.10.4">
<h3><span class="header-section-number">4.10.4</span> Average first, compute after</h3>
</div>
</div>
<div id="summary-2" class="section level2" number="4.11">
<h2><span class="header-section-number">4.11</span> Summary</h2>
</div>
<div id="suggested-reading-2" class="section level2" number="4.12">
<h2><span class="header-section-number">4.12</span> Suggested reading</h2>
<!--chapter:end:3-hmm.Rmd-->
</div>
</div>
<div id="part-transitions" class="section level1 unnumbered">
<h1 class="unnumbered">(PART) Transitions</h1>
</div>
<div id="introduction-4" class="section level1 unnumbered">
<h1 class="unnumbered">Introduction</h1>
<p>WORK IN PROGRESS</p>
<p>This second part <code>Transitions</code> will teach you all about capture-recapture models for open populations, with reproducible R code to ease the learning process.</p>
<!--chapter:end:introductionparttwo.Rmd-->
</div>
<div id="survival" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Alive and dead</h1>
<p>Placeholder</p>
<div id="introduction-5" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Introduction</h2>
</div>
<div id="the-cormack-jolly-seber-cjs-model" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> The Cormack-Jolly-Seber (CJS) model</h2>
</div>
<div id="capture-recapture-data" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> Capture-recapture data</h2>
</div>
<div id="fitting-the-cjs-model-to-the-dipper-data-with-nimble" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> Fitting the CJS model to the dipper data with NIMBLE</h2>
</div>
<div id="cjsderivatives" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> CJS model derivatives</h2>
</div>
<div id="waic" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> Model comparison with WAIC</h2>
</div>
<div id="gof" class="section level2" number="5.7">
<h2><span class="header-section-number">5.7</span> Goodness of fit</h2>
<div id="posterior-predictive-checks" class="section level3" number="5.7.1">
<h3><span class="header-section-number">5.7.1</span> Posterior predictive checks</h3>
</div>
<div id="classical-tests" class="section level3" number="5.7.2">
<h3><span class="header-section-number">5.7.2</span> Classical tests</h3>
</div>
<div id="design-considerations" class="section level3" number="5.7.3">
<h3><span class="header-section-number">5.7.3</span> Design considerations</h3>
</div>
</div>
<div id="covariates" class="section level2" number="5.8">
<h2><span class="header-section-number">5.8</span> Covariates</h2>
<div id="temporal-covariates" class="section level3" number="5.8.1">
<h3><span class="header-section-number">5.8.1</span> Temporal covariates</h3>
<div id="discrete" class="section level4" number="5.8.1.1">
<h4><span class="header-section-number">5.8.1.1</span> Discrete</h4>
</div>
<div id="continuous" class="section level4" number="5.8.1.2">
<h4><span class="header-section-number">5.8.1.2</span> Continuous</h4>
</div>
</div>
<div id="individual-covariates" class="section level3" number="5.8.2">
<h3><span class="header-section-number">5.8.2</span> Individual covariates</h3>
<div id="discrete-1" class="section level4" number="5.8.2.1">
<h4><span class="header-section-number">5.8.2.1</span> Discrete</h4>
</div>
<div id="continuous-1" class="section level4" number="5.8.2.2">
<h4><span class="header-section-number">5.8.2.2</span> Continuous</h4>
</div>
</div>
<div id="several-covariates" class="section level3" number="5.8.3">
<h3><span class="header-section-number">5.8.3</span> Several covariates</h3>
</div>
<div id="random-effects" class="section level3" number="5.8.4">
<h3><span class="header-section-number">5.8.4</span> Random effects</h3>
</div>
<div id="individual-time-varying-covariates" class="section level3" number="5.8.5">
<h3><span class="header-section-number">5.8.5</span> Individual time-varying covariates</h3>
</div>
</div>
<div id="elicitprior" class="section level2" number="5.9">
<h2><span class="header-section-number">5.9</span> Why Bayes? Incorporate prior information</h2>
<div id="prior-elicitation" class="section level3" number="5.9.1">
<h3><span class="header-section-number">5.9.1</span> Prior elicitation</h3>
</div>
<div id="moment-matching" class="section level3" number="5.9.2">
<h3><span class="header-section-number">5.9.2</span> Moment matching</h3>
</div>
</div>
<div id="summary-3" class="section level2" number="5.10">
<h2><span class="header-section-number">5.10</span> Summary</h2>
</div>
<div id="suggested-reading-3" class="section level2" number="5.11">
<h2><span class="header-section-number">5.11</span> Suggested reading</h2>
<!--chapter:end:4-survive.Rmd-->
</div>
</div>
<div id="dispersal" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Sites and states</h1>
<p>Placeholder</p>
<div id="introduction-6" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Introduction</h2>
</div>
<div id="ASmodel" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> The Arnason-Schwarz (AS) model</h2>
<div id="theory" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Theory</h3>
</div>
</div>
<div id="ASmodelfitting" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Fitting the AS model</h2>
<div id="geese-data" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Geese data</h3>
</div>
<div id="nimble-implementation-1" class="section level3" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> NIMBLE implementation</h3>
</div>
<div id="gofas" class="section level3" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Goodness of fit</h3>
</div>
</div>
<div id="what-if-more-than-2-sites" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> What if more than 2 sites?</h2>
<div id="dirichlet-prior" class="section level3" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Dirichlet prior</h3>
</div>
<div id="multinomiallogit" class="section level3" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Multinomial logit</h3>
</div>
</div>
<div id="states" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Sites may be states</h2>
<div id="titis-data" class="section level3" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Titis data</h3>
</div>
<div id="the-as-model-for-states" class="section level3" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> The AS model for states</h3>
</div>
<div id="nimble-implementation-2" class="section level3" number="6.5.3">
<h3><span class="header-section-number">6.5.3</span> NIMBLE implementation</h3>
</div>
</div>
<div id="localminima" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> Issue of local minima</h2>
</div>
<div id="multievent" class="section level2" number="6.7">
<h2><span class="header-section-number">6.7</span> Uncertainty</h2>
<div id="breedingmultievent" class="section level3" number="6.7.1">
<h3><span class="header-section-number">6.7.1</span> Breeding states</h3>
</div>
<div id="diseasemultievent" class="section level3" number="6.7.2">
<h3><span class="header-section-number">6.7.2</span> Disease states</h3>
</div>
</div>
<div id="summary-4" class="section level2" number="6.8">
<h2><span class="header-section-number">6.8</span> Summary</h2>
</div>
<div id="suggested-reading-4" class="section level2" number="6.9">
<h2><span class="header-section-number">6.9</span> Suggested reading</h2>
<!--chapter:end:5-move.Rmd-->
</div>
</div>
<div id="part-case-studies" class="section level1 unnumbered">
<h1 class="unnumbered">(PART) Case studies</h1>
</div>
<div id="introduction-7" class="section level1 unnumbered">
<h1 class="unnumbered">Introduction</h1>
<p>This third part <code>Case studies</code> provides real-world case studies from the scientific literature that you can reproduce using material covered in previous chapters. These problems can either i) be used to cement and deepen your understanding of methods and models, ii) be adapted for your own purpose, or iii) serve as teaching projects. For each case study, I recall the ecological question, then build the model step by step and conclude by discussing the results. The code and data are available <strong>say where</strong>.</p>
<!--chapter:end:introductionpartthree.Rmd-->
</div>
<div id="covariateschapter" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Covariates</h1>
<p>Placeholder</p>
<div id="covariate-selection-with-reversible-jump-mcmc" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Covariate selection with reversible jump MCMC</h2>
</div>
<div id="naincov" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Missing values</h2>
</div>
<div id="sex-uncertainty" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Sex uncertainty</h2>
</div>
<div id="nonlinearities" class="section level2" number="7.4">
<h2><span class="header-section-number">7.4</span> Nonlinearities</h2>
</div>
<div id="spatial" class="section level2" number="7.5">
<h2><span class="header-section-number">7.5</span> Spatial</h2>
<!--chapter:end:6-covariates.Rmd-->
</div>
</div>
<div id="lackoffit" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Lack of fit</h1>
<p>Placeholder</p>
<div id="individual-heterogeneity" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Individual heterogeneity</h2>
</div>
<div id="trapdep" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Trap dep</h2>
</div>
<div id="transience" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Transience</h2>
</div>
<div id="temporary-emigration" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Temporary emigration</h2>
</div>
<div id="memorymodel" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Memory model</h2>
</div>
<div id="ppchecks" class="section level2" number="8.6">
<h2><span class="header-section-number">8.6</span> Posterior predictive check</h2>
<!--chapter:end:7-lackoffit.Rmd-->
</div>
</div>
<div id="tradeoffs" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Life history</h1>
<p>Placeholder</p>
<div id="access-to-reproduction" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Access to reproduction</h2>
</div>
<div id="casestudytradeoff" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Tradeoffs</h2>
</div>
<div id="breeding-dynamics" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Breeding dynamics</h2>
</div>
<div id="using-data-on-dead-recoveries" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> Using data on dead recoveries</h2>
<div id="ring-recovery-simple-model" class="section level3" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> Ring recovery simple model</h3>
</div>
<div id="combination-of-live-captures-and-dead-recoveries" class="section level3" number="9.4.2">
<h3><span class="header-section-number">9.4.2</span> Combination of live captures and dead recoveries</h3>
</div>
<div id="cause-specific-mortalities" class="section level3" number="9.4.3">
<h3><span class="header-section-number">9.4.3</span> Cause-specific mortalities</h3>
</div>
</div>
<div id="stopover-duration" class="section level2" number="9.5">
<h2><span class="header-section-number">9.5</span> Stopover duration</h2>
</div>
<div id="actuarial-senescence" class="section level2" number="9.6">
<h2><span class="header-section-number">9.6</span> Actuarial senescence</h2>
</div>
<div id="uncertainty-in-age" class="section level2" number="9.7">
<h2><span class="header-section-number">9.7</span> Uncertainty in age</h2>
</div>
<div id="uncertainty-in-age-and-size" class="section level2" number="9.8">
<h2><span class="header-section-number">9.8</span> Uncertainty in age and size</h2>
<!--chapter:end:8-lifehistory.Rmd-->
</div>
</div>
<div id="conclusion" class="section level1 unnumbered">
<h1 class="unnumbered">Conclusion</h1>
<p>I hope to have convinced you that hidden Markov models combined with the Bayesian framework are very flexible to analyse capture-recapture data. With your data, you may ask a myriad of questions. The limit is your imagination (and CPU time).</p>
<p>Let me leave you with a few pieces of advice. This is not rocket science, just a few things based on my own experience of building HMM to analyse data with Bayesian statistics.</p>
<ul>
<li><p><strong>Make your ecological question explicit.</strong> First things first. Make sure you’ve spent some to time to make your ecological question explicit. This step will help you to stay on course, and make the right choices. For example, it’s fine to use subsets of your data to address different questions.</p></li>
<li><p>Now in terms of modeling. <strong>Think of observations and states first.</strong> Don’t jump on your keyboard right away. Spend some time thinking about your model with pen and paper. In particular make sure you have the observations and the states of your HMM. <strong>Then write down the observation and transition matrices on paper.</strong> Write down the transition matrix. You may act as if you had no imperfect detection. This is really what you’re after, the ecological process (survival, dispersal, etc). Proceed with the observation matrix.</p></li>
<li><p>When it comes to model fitting with NIMBLE, <strong>start simple</strong>, with all parameters constant for example. Make sure convergence is reached. Then <strong>add complexity one step at a time</strong>. Time effect for example, or random effects, or uncertainty in the assignment of states.</p></li>
<li><p><strong>Consider doing simulations</strong> to better understand your model. When it comes to model building, consider simulating data to better understand your model. You will always learn something on your model by seeing it an engine to generate data, instead of estimating its parameters. The nice thing with NIMBLE is that you can use your model to simulate data.</p></li>
<li><p>Another advice, quite general in programming, is to not try to optimize your code or to try to make it elegant right away. <strong>Make your model work first, then think of optimization</strong>.</p></li>
</ul>
<!--chapter:end:999-conclusions.Rmd-->
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<!--chapter:end:references.Rmd-->
</div>
<!--bookdown:body:end-->
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Bayesian analysis of capture-recapture data with hidden Markov models</strong>: Theory and case studies in R and NIMBLE" was written by Olivier Gimenez. It was last built on 2025-08-06.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


</body>

</html>

<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 8 State uncertainty | Bayesian Analysis of Capture-Recapture Data with Hidden Markov Models</title>
<meta name="author" content="Olivier Gimenez">
<meta name="description" content="WORK IN PROGRESS.  8.1 Introduction In this module, we’re going to talk about multievent models. Multievent models extend multistate models with uncertainty in state assignment. Let’s see some...">
<meta name="generator" content="bookdown 0.23 with bs4_book()">
<meta property="og:title" content="Chapter 8 State uncertainty | Bayesian Analysis of Capture-Recapture Data with Hidden Markov Models">
<meta property="og:type" content="book">
<meta property="og:url" content="https://oliviergimenez.github.io/bayesian-cr-workshop/uncertainty.html">
<meta property="og:description" content="WORK IN PROGRESS.  8.1 Introduction In this module, we’re going to talk about multievent models. Multievent models extend multistate models with uncertainty in state assignment. Let’s see some...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 8 State uncertainty | Bayesian Analysis of Capture-Recapture Data with Hidden Markov Models">
<meta name="twitter:description" content="WORK IN PROGRESS.  8.1 Introduction In this module, we’re going to talk about multievent models. Multievent models extend multistate models with uncertainty in state assignment. Let’s see some...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="bs4_style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="Theory and Case Studies in R">Bayesian Analysis of Capture-Recapture Data with Hidden Markov Models</a>:
        <small class="text-muted">Theory and Case Studies in R</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Welcome</a></li>
<li><a class="" href="preface.html">Preface</a></li>
<li><a class="" href="about-the-author.html">About the author</a></li>
<li class="book-part">I. Fundations</li>
<li><a class="" href="introduction.html">Introduction</a></li>
<li><a class="" href="crashcourse.html"><span class="header-section-number">1</span> Bayesian statistics &amp; MCMC</a></li>
<li><a class="" href="intronimble.html"><span class="header-section-number">2</span> NIMBLE tutorial</a></li>
<li><a class="" href="hmmcapturerecapture.html"><span class="header-section-number">3</span> Hidden Markov models</a></li>
<li class="book-part">II. Transitions</li>
<li><a class="" href="introduction-4.html">Introduction</a></li>
<li><a class="" href="survival.html"><span class="header-section-number">4</span> Survival</a></li>
<li><a class="" href="dispersal.html"><span class="header-section-number">5</span> Dispersal</a></li>
<li><a class="" href="covariates.html"><span class="header-section-number">6</span> Covariates</a></li>
<li><a class="" href="model-selection.html"><span class="header-section-number">7</span> Model selection and validation</a></li>
<li class="book-part">III. States</li>
<li><a class="" href="introduction-7.html">Introduction</a></li>
<li><a class="active" href="uncertainty.html"><span class="header-section-number">8</span> State uncertainty</a></li>
<li><a class="" href="hsmm.html"><span class="header-section-number">9</span> Hidden semi-Markov models</a></li>
<li class="book-part">IV. Case studies</li>
<li><a class="" href="introduction-9.html">Introduction</a></li>
<li><a class="" href="tradeoffs.html"><span class="header-section-number">10</span> Life history theory</a></li>
<li><a class="" href="abundance.html"><span class="header-section-number">11</span> Abundance</a></li>
<li><a class="" href="stopover.html"><span class="header-section-number">12</span> Stopover duration</a></li>
<li><a class="" href="individual-dependence.html"><span class="header-section-number">13</span> Individual dependence</a></li>
<li class="book-part">V. Conclusion</li>
<li><a class="" href="take-home-messages.html">Take-home messages</a></li>
<li><a class="" href="faq.html">FAQ</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/oliviergimenez/banana-book">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="uncertainty" class="section level1" number="8">
<h1>
<span class="header-section-number">8</span> State uncertainty<a class="anchor" aria-label="anchor" href="#uncertainty"><i class="fas fa-link"></i></a>
</h1>
<p>WORK IN PROGRESS.</p>
<div id="introduction-8" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> Introduction<a class="anchor" aria-label="anchor" href="#introduction-8"><i class="fas fa-link"></i></a>
</h2>
<p>In this module, we’re going to talk about multievent models. Multievent models extend multistate models with uncertainty in state assignment. Let’s see some examples to fix ideas. These examples are from published papers which used multievent models.</p>
<ul>
<li><p>Breeding status in female roe deer is ascertained based on fawn detection</p></li>
<li><p>Sex status is ascertained based on morphological criteria in Audouin’s gulls</p></li>
<li><p>Disease status in house finches is ascertained based on birds’ eyes examination</p></li>
<li><p>Hybrid status in wolves is ascertained based on genetics</p></li>
<li><p>Dominance status in wolves is ascertained based on heterogeneity in detection</p></li>
</ul>
<p>The common thing to all these examples is that. We need to explicitly consider state assignment in a model. HMMs to the rescue! And to do that, we’ll use HMMs again!</p>
<p>Examples</p>
<ul>
<li><p>Testing life-history trade-offs while accounting for uncertainty in breeding status</p></li>
<li><p>Quantifying disease dynamics while accounting for uncertainty in disease status</p></li>
<li><p>Estimating survival while accounting for individual heterogeneity in detection</p></li>
<li><p>In this module, I’ll go through 3 examples.</p></li>
<li><p>Testing life-history trade-offs while accounting for uncertainty in breeding status.</p></li>
<li><p>Quantifying disease dynamics while accounting for uncertainty in disease status.</p></li>
<li><p>Estimating survival while accounting for individual heterogeneity in detection.</p></li>
<li><p><strong>Testing life-history trade-offs while accounting for uncertainty in breeding status</strong></p></li>
<li><p>Quantifying disease dynamics while accounting for uncertainty in disease status</p></li>
<li><p>Estimating survival while accounting for individual heterogeneity in detection</p></li>
</ul>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="st">"images/sooty.jpg"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="images/sooty.jpg" width="900"></div>
</div>
<div id="uncertainty-in-breeding-status-sooty-shearwater-david-boyle" class="section level2" number="8.2">
<h2>
<span class="header-section-number">8.2</span> Uncertainty in breeding status: Sooty shearwater (David Boyle)<a class="anchor" aria-label="anchor" href="#uncertainty-in-breeding-status-sooty-shearwater-david-boyle"><i class="fas fa-link"></i></a>
</h2>
<div id="ingredients" class="section level3" number="8.2.1">
<h3>
<span class="header-section-number">8.2.1</span> Ingredients<a class="anchor" aria-label="anchor" href="#ingredients"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>3 states
<ul>
<li>breeding (B)</li>
<li>non-breeding (NB)</li>
<li>dead (D)</li>
</ul>
</li>
<li>4 observations
<ul>
<li>not encountered (0)</li>
<li>found, ascertained as breeder (1)</li>
<li>found, ascertained as non-breeder (2)</li>
<li>found, status unknown (3)</li>
</ul>
</li>
<li>We still have 3 states, breeding, non-breeding and dead.</li>
<li>With regard to observations, a bird may be not encountered.</li>
<li>It may also be encountered, but in contrast with multistate CR data, we don’t know its state for sure.</li>
<li>It may be found and ascertained or classified as breeder.</li>
<li>It may be found and ascertained or classified as non-breeder.</li>
<li>It may be found be we are unable to determine whether it’s breeding or non-breeding.</li>
</ul>
</div>
<div id="how-states-generate-observations" class="section level3" number="8.2.2">
<h3>
<span class="header-section-number">8.2.2</span> How states generate observations<a class="anchor" aria-label="anchor" href="#how-states-generate-observations"><i class="fas fa-link"></i></a>
</h3>
<div class="inline-figure"><img src="banana-book_files/figure-html/unnamed-chunk-259-1.png" width="672"></div>
<p>Now how do the states generate the observations?</p>
<div class="inline-figure"><img src="banana-book_files/figure-html/unnamed-chunk-260-1.png" width="672"></div>
<div class="inline-figure"><img src="banana-book_files/figure-html/unnamed-chunk-261-1.png" width="672"></div>
<div class="inline-figure"><img src="banana-book_files/figure-html/unnamed-chunk-262-1.png" width="672"></div>
<div class="inline-figure"><img src="banana-book_files/figure-html/unnamed-chunk-263-1.png" width="672"></div>
<p>To wrap up each live state can generate 3 observations. The only deterministic link is that between the dead state and the observation non-encountered. Cause if you’re dead, you cannot be detected for sure.</p>
</div>
<div id="hmm-model-for-breeding-states-with-uncertainty" class="section level3" number="8.2.3">
<h3>
<span class="header-section-number">8.2.3</span> HMM model for breeding states with uncertainty<a class="anchor" aria-label="anchor" href="#hmm-model-for-breeding-states-with-uncertainty"><i class="fas fa-link"></i></a>
</h3>
<p>Vector of initial state probabilities</p>
<p><span class="math display">\[
\begin{matrix}
&amp; \\
\mathbf{\delta} =
    \left ( \vphantom{ \begin{matrix} 12 \end{matrix} } \right .
\end{matrix}
\hspace{-1.2em}
\begin{matrix}
    z_t=B &amp; z_t=NB &amp; z_t=D \\ \hdashline
\pi_B &amp; 1 - \pi_{B} &amp; 0\\
\end{matrix}
\hspace{-0.2em}
\begin{matrix}
&amp; \\
\left . \vphantom{ \begin{matrix} 12 \end{matrix} } \right )
    \begin{matrix}
    \end{matrix}
\end{matrix}
\]</span></p>
<p><span class="math inline">\(\pi_B\)</span> is the probability that a newly encountered individual is a breeder. <span class="math inline">\(\pi_{NB} = 1 - \pi_B\)</span> is the probability that a newly encountered individual is a non-breeder</p>
<p>OK now let’s specify the model. First thing we need, and it’s a big difference with multistate models, we need initial state probabilities cause we cannot assign states to individuals w/ certainty. Let’s define pi_B the prob that a newly encountered individual is a breeding individual. We write down the prob for each state at first encounter. We have pi_B, then the prob of being a NB is the complementary. And the prob of being dead at first encounter is 0 of course.</p>
<p>Transition matrix</p>
<p><span class="math display">\[
\begin{matrix}
&amp; \\
\mathbf{\Gamma} =
    \left ( \vphantom{ \begin{matrix} 12 \\ 12 \\ 12 \end{matrix} } \right .
\end{matrix}
\hspace{-1.2em}
\begin{matrix}
    z_t=B &amp; z_t=NB &amp; z_t=D \\ \hdashline
\phi_B (1-\psi_{BNB}) &amp; \phi_B \psi_{BNB} &amp; 1 - \phi_B\\
\phi_{NB} \psi_{NBB} &amp; \phi_{NB} (1-\psi_{NBB}) &amp; 1 - \phi_{NB}\\
0 &amp; 0 &amp; 1
\end{matrix}
\hspace{-0.2em}
\begin{matrix}
&amp; \\
\left . \vphantom{ \begin{matrix} 12 \\ 12 \\ 12 \end{matrix} } \right )
    \begin{matrix}
    z_{t-1}=B \\ z_{t-1}=NB \\ z_{t-1}=D
    \end{matrix}
\end{matrix}
\]</span></p>
<p><span class="math inline">\(\phi_B\)</span> is breeder survival, <span class="math inline">\(\phi_{NB}\)</span> that of non-breeders. <span class="math inline">\(\psi_{BNB}\)</span> is the probability for an individual breeding a year to be a non-breeder the next year. <span class="math inline">\(\psi_{NBB}\)</span> is the probability for an non-breeder individual to breeder the next year. The transition parameters are in a matrix similar to the one we used for multistate models.</p>
<p>Observation matrix</p>
<p><span class="math display">\[
\begin{matrix}
&amp; \\
\mathbf{\Omega} =
    \left ( \vphantom{ \begin{matrix} 12 \\ 12 \\ 12\end{matrix} } \right .
\end{matrix}
\hspace{-1.2em}
\begin{matrix}
    y_t=0 &amp; y_t=1 &amp; y_t=2 &amp; y_t=3\\ \hdashline
1 - p_B &amp; p_B \beta_B &amp; 0 &amp; p_B (1-\beta_B) \\
1-p_{NB} &amp; 0 &amp; p_{NB} \beta_{NB} &amp; p_{NB} (1-\beta_{NB})\\
1 &amp; 0 &amp; 0 &amp; 0
\end{matrix}
\hspace{-0.2em}
\begin{matrix}
&amp; \\
\left . \vphantom{ \begin{matrix} 12 \\ 12 \\ 12\end{matrix} } \right )
    \begin{matrix}
    z_{t}=B \\ z_{t}=NB \\ z_{t}=D
    \end{matrix}
\end{matrix}
\]</span></p>
<p><span class="math inline">\(\beta_B\)</span> is the probability to assign an individual in state B to state B. <span class="math inline">\(\beta_{NB}\)</span> is the probability to assign an individual in state NB to state NB. <span class="math inline">\(p_B\)</span> is the detection probability of breeders, <span class="math inline">\(p_{NB}\)</span> that of non-breeders.</p>
<p>The main difference between multistate and multievent models is here, in the observation parameters. We introduce two new parameters. <span class="math inline">\(\delta_B\)</span>: prob. to correctly assign an indiv. that is in state B to state B, <span class="math inline">\(\delta_{NB}\)</span>: prob. to correctly assign an indiv. that is in state NB to state NB. We put everything in a matrix, as usual. The observation matrix. In rows we have the states, breeding, non-breeding and dead. In columns, at the same occasion, we have the observation, detected and ascertained B,
detected and ascertained NB, detected and state unknown, and not detected. For example, the prob of being detected and assigned to the state B, given that you’re in state B is the product of the detection prob in B and delta the prob of correctly assigning a B individual to state B.</p>
<p>Because animals are all captured, <span class="math inline">\(p_B = p_{NB} = 1\)</span> at first encounter:</p>
<p><span class="math display">\[
\begin{matrix}
&amp; \\
    \left ( \vphantom{ \begin{matrix} 12 \\ 12 \\ 12\end{matrix} } \right .
\end{matrix}
\hspace{-1.2em}
\begin{matrix}
    y_t=0 &amp; y_t=1 &amp; y_t=2 &amp; y_t=3\\ \hdashline
 0 &amp; \beta_B &amp; 0 &amp; (1-\beta_B)\\
0 &amp; 0 &amp; \beta_{NB} &amp; (1-\beta_{NB})\\
1 &amp; 0 &amp; 0 &amp; 0
\end{matrix}
\hspace{-0.2em}
\begin{matrix}
&amp; \\
\left . \vphantom{ \begin{matrix} 12 \\ 12 \\ 12\end{matrix} } \right )
    \begin{matrix}
    z_{t}=B \\ z_{t}=NB \\ z_{t}=D
    \end{matrix}
\end{matrix}
\]</span></p>
<p>Note: Breeding assessment is unaffected. Then at first encounter, what happens is that step 1 of encounter is degenerate because individuals are all captured. Just set all the p’s to 1 in the encounter matrix. The breeding assessment matrix remains unchanged.</p>
</div>
<div id="our-model-phi_b-phi_nb-psi_bnb-psi_nbb-p_b-p_nb-beta_b-beta_nb-pi" class="section level3" number="8.2.4">
<h3>
<span class="header-section-number">8.2.4</span> Our model <span class="math inline">\((\phi_B, \phi_{NB}, \psi_{BNB}, \psi_{NBB}, p_B, p_{NB}, \beta_B, \beta_{NB}, \pi)\)</span><a class="anchor" aria-label="anchor" href="#our-model-phi_b-phi_nb-psi_bnb-psi_nbb-p_b-p_nb-beta_b-beta_nb-pi"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="uncertainty.html#cb181-1" aria-hidden="true" tabindex="-1"></a>multievent <span class="ot">&lt;-</span> <span class="fu">nimbleCode</span>({</span>
<span id="cb181-2"><a href="uncertainty.html#cb181-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -------------------------------------------------</span></span>
<span id="cb181-3"><a href="uncertainty.html#cb181-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Parameters:</span></span>
<span id="cb181-4"><a href="uncertainty.html#cb181-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># phiB: survival probability state B</span></span>
<span id="cb181-5"><a href="uncertainty.html#cb181-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># phiNB: survival probability state NB</span></span>
<span id="cb181-6"><a href="uncertainty.html#cb181-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># psiBNB: transition probability from B to NB</span></span>
<span id="cb181-7"><a href="uncertainty.html#cb181-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># psiNBB: transition probability from NB to B</span></span>
<span id="cb181-8"><a href="uncertainty.html#cb181-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pB: recapture probability B</span></span>
<span id="cb181-9"><a href="uncertainty.html#cb181-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pNB: recapture probability NB</span></span>
<span id="cb181-10"><a href="uncertainty.html#cb181-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># piB prob. of being in initial state breeder</span></span>
<span id="cb181-11"><a href="uncertainty.html#cb181-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># betaNB prob to ascertain the breeding status of an individual encountered as non-breeder</span></span>
<span id="cb181-12"><a href="uncertainty.html#cb181-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># betaB prob to ascertain the breeding status of an individual encountered as breeder</span></span>
<span id="cb181-13"><a href="uncertainty.html#cb181-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -------------------------------------------------</span></span>
<span id="cb181-14"><a href="uncertainty.html#cb181-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># States (z):</span></span>
<span id="cb181-15"><a href="uncertainty.html#cb181-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1 alive B</span></span>
<span id="cb181-16"><a href="uncertainty.html#cb181-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2 alive NB</span></span>
<span id="cb181-17"><a href="uncertainty.html#cb181-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3 dead</span></span>
<span id="cb181-18"><a href="uncertainty.html#cb181-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Observations (y):</span></span>
<span id="cb181-19"><a href="uncertainty.html#cb181-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1 = non-detected</span></span>
<span id="cb181-20"><a href="uncertainty.html#cb181-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2 = seen and ascertained as breeder</span></span>
<span id="cb181-21"><a href="uncertainty.html#cb181-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3 = seen and ascertained as non-breeder</span></span>
<span id="cb181-22"><a href="uncertainty.html#cb181-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4 = not ascertained</span></span>
<span id="cb181-23"><a href="uncertainty.html#cb181-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># -------------------------------------------------</span></span>
<span id="cb181-24"><a href="uncertainty.html#cb181-24" aria-hidden="true" tabindex="-1"></a>...</span></code></pre></div>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="uncertainty.html#cb182-1" aria-hidden="true" tabindex="-1"></a>multievent <span class="ot">&lt;-</span> <span class="fu">nimbleCode</span>({</span>
<span id="cb182-2"><a href="uncertainty.html#cb182-2" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb182-3"><a href="uncertainty.html#cb182-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Priors</span></span>
<span id="cb182-4"><a href="uncertainty.html#cb182-4" aria-hidden="true" tabindex="-1"></a>  phiB <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb182-5"><a href="uncertainty.html#cb182-5" aria-hidden="true" tabindex="-1"></a>  phiNB <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb182-6"><a href="uncertainty.html#cb182-6" aria-hidden="true" tabindex="-1"></a>  psiBNB <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb182-7"><a href="uncertainty.html#cb182-7" aria-hidden="true" tabindex="-1"></a>  psiNBB <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb182-8"><a href="uncertainty.html#cb182-8" aria-hidden="true" tabindex="-1"></a>  pB <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb182-9"><a href="uncertainty.html#cb182-9" aria-hidden="true" tabindex="-1"></a>  pNB <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb182-10"><a href="uncertainty.html#cb182-10" aria-hidden="true" tabindex="-1"></a>  piB <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb182-11"><a href="uncertainty.html#cb182-11" aria-hidden="true" tabindex="-1"></a>  betaNB <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb182-12"><a href="uncertainty.html#cb182-12" aria-hidden="true" tabindex="-1"></a>  betaB <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb182-13"><a href="uncertainty.html#cb182-13" aria-hidden="true" tabindex="-1"></a>...</span></code></pre></div>
<p>]</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="uncertainty.html#cb183-1" aria-hidden="true" tabindex="-1"></a>multievent <span class="ot">&lt;-</span> <span class="fu">nimbleCode</span>({</span>
<span id="cb183-2"><a href="uncertainty.html#cb183-2" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb183-3"><a href="uncertainty.html#cb183-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vector of initial stats probs</span></span>
<span id="cb183-4"><a href="uncertainty.html#cb183-4" aria-hidden="true" tabindex="-1"></a>  delta[<span class="dv">1</span>] <span class="ot">&lt;-</span> piB <span class="co"># prob. of being in initial state B</span></span>
<span id="cb183-5"><a href="uncertainty.html#cb183-5" aria-hidden="true" tabindex="-1"></a>  delta[<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> piB <span class="co"># prob. of being in initial state NB</span></span>
<span id="cb183-6"><a href="uncertainty.html#cb183-6" aria-hidden="true" tabindex="-1"></a>  delta[<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># prob. of being in initial state dead</span></span>
<span id="cb183-7"><a href="uncertainty.html#cb183-7" aria-hidden="true" tabindex="-1"></a>...</span></code></pre></div>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="uncertainty.html#cb184-1" aria-hidden="true" tabindex="-1"></a>multievent <span class="ot">&lt;-</span> <span class="fu">nimbleCode</span>({</span>
<span id="cb184-2"><a href="uncertainty.html#cb184-2" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb184-3"><a href="uncertainty.html#cb184-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># probabilities of state z(t+1) given z(t)</span></span>
<span id="cb184-4"><a href="uncertainty.html#cb184-4" aria-hidden="true" tabindex="-1"></a>  gamma[<span class="dv">1</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> phiB <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> psiBNB)</span>
<span id="cb184-5"><a href="uncertainty.html#cb184-5" aria-hidden="true" tabindex="-1"></a>  gamma[<span class="dv">1</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> phiB <span class="sc">*</span> psiBNB</span>
<span id="cb184-6"><a href="uncertainty.html#cb184-6" aria-hidden="true" tabindex="-1"></a>  gamma[<span class="dv">1</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> phiB</span>
<span id="cb184-7"><a href="uncertainty.html#cb184-7" aria-hidden="true" tabindex="-1"></a>  gamma[<span class="dv">2</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> phiNB <span class="sc">*</span> psiNBB</span>
<span id="cb184-8"><a href="uncertainty.html#cb184-8" aria-hidden="true" tabindex="-1"></a>  gamma[<span class="dv">2</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> phiNB <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> psiNBB)</span>
<span id="cb184-9"><a href="uncertainty.html#cb184-9" aria-hidden="true" tabindex="-1"></a>  gamma[<span class="dv">2</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> phiNB</span>
<span id="cb184-10"><a href="uncertainty.html#cb184-10" aria-hidden="true" tabindex="-1"></a>  gamma[<span class="dv">3</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb184-11"><a href="uncertainty.html#cb184-11" aria-hidden="true" tabindex="-1"></a>  gamma[<span class="dv">3</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb184-12"><a href="uncertainty.html#cb184-12" aria-hidden="true" tabindex="-1"></a>  gamma[<span class="dv">3</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb184-13"><a href="uncertainty.html#cb184-13" aria-hidden="true" tabindex="-1"></a>...</span></code></pre></div>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="uncertainty.html#cb185-1" aria-hidden="true" tabindex="-1"></a>multievent <span class="ot">&lt;-</span> <span class="fu">nimbleCode</span>({</span>
<span id="cb185-2"><a href="uncertainty.html#cb185-2" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb185-3"><a href="uncertainty.html#cb185-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># probabilities of y(t) given z(t)</span></span>
<span id="cb185-4"><a href="uncertainty.html#cb185-4" aria-hidden="true" tabindex="-1"></a>  omega[<span class="dv">1</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> pB             <span class="co"># Pr(alive B t -&gt; non-detected t)</span></span>
<span id="cb185-5"><a href="uncertainty.html#cb185-5" aria-hidden="true" tabindex="-1"></a>  omega[<span class="dv">1</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> pB <span class="sc">*</span> betaB         <span class="co"># Pr(alive B t -&gt; detected B t)</span></span>
<span id="cb185-6"><a href="uncertainty.html#cb185-6" aria-hidden="true" tabindex="-1"></a>  omega[<span class="dv">1</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>                  <span class="co"># Pr(alive B t -&gt; detected NB t)</span></span>
<span id="cb185-7"><a href="uncertainty.html#cb185-7" aria-hidden="true" tabindex="-1"></a>  omega[<span class="dv">1</span>,<span class="dv">4</span>] <span class="ot">&lt;-</span> pB <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> betaB)   <span class="co"># Pr(alive B t -&gt; detected U t)</span></span>
<span id="cb185-8"><a href="uncertainty.html#cb185-8" aria-hidden="true" tabindex="-1"></a>  omega[<span class="dv">2</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> pNB            <span class="co"># Pr(alive NB t -&gt; non-detected t)</span></span>
<span id="cb185-9"><a href="uncertainty.html#cb185-9" aria-hidden="true" tabindex="-1"></a>  omega[<span class="dv">2</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>                  <span class="co"># Pr(alive NB t -&gt; detected B t)</span></span>
<span id="cb185-10"><a href="uncertainty.html#cb185-10" aria-hidden="true" tabindex="-1"></a>  omega[<span class="dv">2</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> pNB <span class="sc">*</span> betaNB       <span class="co"># Pr(alive NB t -&gt; detected NB t)</span></span>
<span id="cb185-11"><a href="uncertainty.html#cb185-11" aria-hidden="true" tabindex="-1"></a>  omega[<span class="dv">2</span>,<span class="dv">4</span>] <span class="ot">&lt;-</span> pNB <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> betaNB) <span class="co"># Pr(alive NB t -&gt; detected U t)</span></span>
<span id="cb185-12"><a href="uncertainty.html#cb185-12" aria-hidden="true" tabindex="-1"></a>  omega[<span class="dv">3</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span>                  <span class="co"># Pr(dead t -&gt; non-detected t)</span></span>
<span id="cb185-13"><a href="uncertainty.html#cb185-13" aria-hidden="true" tabindex="-1"></a>  omega[<span class="dv">3</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>                  <span class="co"># Pr(dead t -&gt; detected N t)</span></span>
<span id="cb185-14"><a href="uncertainty.html#cb185-14" aria-hidden="true" tabindex="-1"></a>  omega[<span class="dv">3</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>                  <span class="co"># Pr(dead t -&gt; detected NB t)</span></span>
<span id="cb185-15"><a href="uncertainty.html#cb185-15" aria-hidden="true" tabindex="-1"></a>  omega[<span class="dv">3</span>,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>                  <span class="co"># Pr(dead t -&gt; detected U t)</span></span>
<span id="cb185-16"><a href="uncertainty.html#cb185-16" aria-hidden="true" tabindex="-1"></a>...</span></code></pre></div>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="uncertainty.html#cb186-1" aria-hidden="true" tabindex="-1"></a>multievent <span class="ot">&lt;-</span> <span class="fu">nimbleCode</span>({</span>
<span id="cb186-2"><a href="uncertainty.html#cb186-2" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb186-3"><a href="uncertainty.html#cb186-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># probabilities of y(first) given z(first)</span></span>
<span id="cb186-4"><a href="uncertainty.html#cb186-4" aria-hidden="true" tabindex="-1"></a>  omega.init[<span class="dv">1</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>          <span class="co"># Pr(alive B t = 1 -&gt; non-detected t = 1)</span></span>
<span id="cb186-5"><a href="uncertainty.html#cb186-5" aria-hidden="true" tabindex="-1"></a>  omega.init[<span class="dv">1</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> betaB      <span class="co"># Pr(alive B t = 1 -&gt; detected B t = 1)</span></span>
<span id="cb186-6"><a href="uncertainty.html#cb186-6" aria-hidden="true" tabindex="-1"></a>  omega.init[<span class="dv">1</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>          <span class="co"># Pr(alive B t = 1 -&gt; detected NB t = 1)</span></span>
<span id="cb186-7"><a href="uncertainty.html#cb186-7" aria-hidden="true" tabindex="-1"></a>  omega.init[<span class="dv">1</span>,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> betaB  <span class="co"># Pr(alive B t = 1 -&gt; detected U t = 1)</span></span>
<span id="cb186-8"><a href="uncertainty.html#cb186-8" aria-hidden="true" tabindex="-1"></a>  omega.init[<span class="dv">2</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>          <span class="co"># Pr(alive NB t = 1 -&gt; non-detected t = 1)</span></span>
<span id="cb186-9"><a href="uncertainty.html#cb186-9" aria-hidden="true" tabindex="-1"></a>  omega.init[<span class="dv">2</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>          <span class="co"># Pr(alive NB t = 1 -&gt; detected B t = 1)</span></span>
<span id="cb186-10"><a href="uncertainty.html#cb186-10" aria-hidden="true" tabindex="-1"></a>  omega.init[<span class="dv">2</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> betaNB     <span class="co"># Pr(alive NB t = 1 -&gt; detected NB t = 1)</span></span>
<span id="cb186-11"><a href="uncertainty.html#cb186-11" aria-hidden="true" tabindex="-1"></a>  omega.init[<span class="dv">2</span>,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> betaNB <span class="co"># Pr(alive NB t = 1 -&gt; detected U t = 1)</span></span>
<span id="cb186-12"><a href="uncertainty.html#cb186-12" aria-hidden="true" tabindex="-1"></a>  omega.init[<span class="dv">3</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">1</span>          <span class="co"># Pr(dead t = 1 -&gt; non-detected t = 1)</span></span>
<span id="cb186-13"><a href="uncertainty.html#cb186-13" aria-hidden="true" tabindex="-1"></a>  omega.init[<span class="dv">3</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>          <span class="co"># Pr(dead t = 1 -&gt; detected N t = 1)</span></span>
<span id="cb186-14"><a href="uncertainty.html#cb186-14" aria-hidden="true" tabindex="-1"></a>  omega.init[<span class="dv">3</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>          <span class="co"># Pr(dead t = 1 -&gt; detected NB t = 1)</span></span>
<span id="cb186-15"><a href="uncertainty.html#cb186-15" aria-hidden="true" tabindex="-1"></a>  omega.init[<span class="dv">3</span>,<span class="dv">4</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>          <span class="co"># Pr(dead t = 1 -&gt; detected U t = 1)</span></span>
<span id="cb186-16"><a href="uncertainty.html#cb186-16" aria-hidden="true" tabindex="-1"></a>...</span></code></pre></div>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">multievent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimbleCode.html">nimbleCode</a></span><span class="op">(</span><span class="op">{</span>
<span class="va">...</span>
  <span class="co"># likelihood</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">N</span><span class="op">)</span><span class="op">{</span>
    <span class="co"># latent state at first capture</span>
    <span class="va">z</span><span class="op">[</span><span class="va">i</span>,<span class="va">first</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/nimble/man/Categorical.html">dcat</a></span><span class="op">(</span><span class="va">delta</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>
    <span class="va">y</span><span class="op">[</span><span class="va">i</span>,<span class="va">first</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/nimble/man/Categorical.html">dcat</a></span><span class="op">(</span><span class="va">omega.init</span><span class="op">[</span><span class="va">z</span><span class="op">[</span><span class="va">i</span>,<span class="va">first</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>
    <span class="kw">for</span> <span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="op">(</span><span class="va">first</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">K</span><span class="op">)</span><span class="op">{</span>
      <span class="co"># z(t) given z(t-1)</span>
      <span class="va">z</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/nimble/man/Categorical.html">dcat</a></span><span class="op">(</span><span class="va">gamma</span><span class="op">[</span><span class="va">z</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>
      <span class="co"># y(t) given z(t)</span>
      <span class="va">y</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/nimble/man/Categorical.html">dcat</a></span><span class="op">(</span><span class="va">omega</span><span class="op">[</span><span class="va">z</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>
    <span class="op">}</span>
  <span class="op">}</span>
<span class="op">}</span><span class="op">)</span></code></pre></div>
</div>
<div id="results" class="section level3" number="8.2.5">
<h3>
<span class="header-section-number">8.2.5</span> Results<a class="anchor" aria-label="anchor" href="#results"><i class="fas fa-link"></i></a>
</h3>
<pre><code>##        mean   sd 2.5%  50% 97.5% Rhat n.eff
## betaB  0.19 0.01 0.16 0.19  0.21 1.01   332
## betaNB 0.76 0.05 0.66 0.76  0.86 1.01    65
## pB     0.56 0.03 0.51 0.56  0.62 1.06   229
## pNB    0.60 0.04 0.53 0.60  0.67 1.03   142
## phiB   0.81 0.02 0.78 0.81  0.85 1.01   312
## phiNB  0.84 0.02 0.80 0.84  0.87 1.00   354
## piB    0.71 0.03 0.66 0.71  0.76 1.02   115
## psiBNB 0.23 0.02 0.18 0.22  0.27 1.00   214
## psiNBB 0.25 0.04 0.17 0.25  0.34 1.00    95</code></pre>
<p>Breeders are difficult to assigned to the correct state. Non-breeders are relatively well classified as non-breeders. No cost of breeding, neither on survival, nor on future reproduction.</p>
<div class="inline-figure"><img src="banana-book_files/figure-html/unnamed-chunk-272-1.png" width="672"></div>
</div>
</div>
<div id="animal-epidemiology-with-uncertain-disease-states" class="section level2" number="8.3">
<h2>
<span class="header-section-number">8.3</span> Animal epidemiology with uncertain disease states<a class="anchor" aria-label="anchor" href="#animal-epidemiology-with-uncertain-disease-states"><i class="fas fa-link"></i></a>
</h2>
<p>Let’s have a look to another example. Very similar to the previous example. We consider a system of an emerging pathogen <em>Mycoplasma gallisepticum</em> Edward and Kanarek and its host the house finch, <em>Carpodacus mexicanus</em> Müller.</p>
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="st">"images/infectedhousefinch.jpg"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="images/infectedhousefinch.jpg" width="640"></div>
<p>A house finch with a heavy infection (Jim Mondok).</p>
<p>We consider a system of an emerging pathogen <em>Mycoplasma gallisepticum</em> Edward and Kanarek and its host the house finch, <em>Carpodacus mexicanus</em> Müller. <a href="https://besjournals.onlinelibrary.wiley.com/doi/10.1111/j.0021-8790.2004.00840.x">Faustino et al. (2004)</a> and <a href="https://besjournals.onlinelibrary.wiley.com/doi/full/10.1111/j.1365-2664.2008.01597.x">Conn &amp; Cooch (2009)</a> studied impact of pathogen on host demographic rates. Problem is true disease state for some encountered individuals is ambiguous because seen at distance. In this context, how to study the dynamics of the disease?</p>
<div id="states-and-observations" class="section level3" number="8.3.1">
<h3>
<span class="header-section-number">8.3.1</span> States and observations<a class="anchor" aria-label="anchor" href="#states-and-observations"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>3 states
<ul>
<li>healthy (H)</li>
<li>ill (I)</li>
<li>dead (D)</li>
</ul>
</li>
<li>4 observations
<ul>
<li>not seen (0)</li>
<li>captured healthy (1)</li>
<li>captured ill (2)</li>
<li>health status unknown, i.e. seen at distance (3)</li>
</ul>
</li>
</ul>
</div>
<div id="how-states-generate-observations." class="section level3" number="8.3.2">
<h3>
<span class="header-section-number">8.3.2</span> How states generate observations.<a class="anchor" aria-label="anchor" href="#how-states-generate-observations."><i class="fas fa-link"></i></a>
</h3>
<div class="inline-figure"><img src="banana-book_files/figure-html/unnamed-chunk-274-1.png" width="672"></div>
<div class="inline-figure"><img src="banana-book_files/figure-html/unnamed-chunk-275-1.png" width="672"></div>
<div class="inline-figure"><img src="banana-book_files/figure-html/unnamed-chunk-276-1.png" width="672"></div>
<div class="inline-figure"><img src="banana-book_files/figure-html/unnamed-chunk-277-1.png" width="672"></div>
<div class="inline-figure"><img src="banana-book_files/figure-html/unnamed-chunk-278-1.png" width="672"></div>
<p>Vector of initial state probabilities</p>
<p><span class="math display">\[
\begin{matrix}
&amp; \\
\mathbf{\delta} =
    \left ( \vphantom{ \begin{matrix} 12 \end{matrix} } \right .
\end{matrix}
\hspace{-1.2em}
\begin{matrix}
    z_t=H &amp; z_t=I &amp; z_t=D \\ \hdashline
\pi_H &amp; 1 - \pi_{H} &amp; 0\\
\end{matrix}
\hspace{-0.2em}
\begin{matrix}
&amp; \\
\left . \vphantom{ \begin{matrix} 12 \end{matrix} } \right )
    \begin{matrix}
    \end{matrix}
\end{matrix}
\]</span></p>
<p><span class="math inline">\(\pi_H\)</span> is the probability that a newly encountered individual is healthy. <span class="math inline">\(\pi_{I} = 1 - \pi_H\)</span> is the probability that a newly encountered individual is ill.</p>
</div>
<div id="hmm-model-for-disease-states-with-uncertainty" class="section level3" number="8.3.3">
<h3>
<span class="header-section-number">8.3.3</span> HMM model for disease states with uncertainty<a class="anchor" aria-label="anchor" href="#hmm-model-for-disease-states-with-uncertainty"><i class="fas fa-link"></i></a>
</h3>
<p>Transition matrix</p>
<p><span class="math display">\[
\begin{matrix}
&amp; \\
\mathbf{\Gamma} =
    \left ( \vphantom{ \begin{matrix} 12 \\ 12 \\ 12 \end{matrix} } \right .
\end{matrix}
\hspace{-1.2em}
\begin{matrix}
    z_t=H &amp; z_t=I &amp; z_t=D \\ \hdashline
\phi_H (1-\psi_{HI}) &amp; \phi_H \psi_{HI} &amp; 1 - \phi_H\\
\phi_{I} \psi_{IH} &amp; \phi_{I} (1-\psi_{IH}) &amp; 1 - \phi_{I}\\
0 &amp; 0 &amp; 1
\end{matrix}
\hspace{-0.2em}
\begin{matrix}
&amp; \\
\left . \vphantom{ \begin{matrix} 12 \\ 12 \\ 12 \end{matrix} } \right )
    \begin{matrix}
    z_{t-1}=H \\ z_{t-1}=I \\ z_{t-1}=D
    \end{matrix}
\end{matrix}
\]</span></p>
<p><span class="math inline">\(\phi_H\)</span> is the survival probability of healthy individuals, <span class="math inline">\(\phi_I\)</span> that of ill individuals. <span class="math inline">\(\psi_{HI}\)</span> is the probability of getting sick, <span class="math inline">\(\psi_{IH}\)</span> that of recovering from the disease.</p>
<p>Transition matrix, incurable disease</p>
<p><span class="math display">\[
\begin{matrix}
&amp; \\
\mathbf{\Gamma} =
    \left ( \vphantom{ \begin{matrix} 12 \\ 12 \\ 12 \end{matrix} } \right .
\end{matrix}
\hspace{-1.2em}
\begin{matrix}
    z_t=H &amp; z_t=I &amp; z_t=D \\ \hdashline
\phi_H (1-\psi_{HI}) &amp; \phi_H \psi_{HI} &amp; 1 - \phi_H\\
0 &amp; \phi_{I}  &amp; 1 - \phi_{I}\\
0 &amp; 0 &amp; 1
\end{matrix}
\hspace{-0.2em}
\begin{matrix}
&amp; \\
\left . \vphantom{ \begin{matrix} 12 \\ 12 \\ 12 \end{matrix} } \right )
    \begin{matrix}
    z_{t-1}=H \\ z_{t-1}=I \\ z_{t-1}=D
    \end{matrix}
\end{matrix}
\]</span></p>
<p>No possibility of recovering from the disease, that is <span class="math inline">\(\psi_{IH} = 0\)</span>. Once you get sick, you remain sick <span class="math inline">\(\psi_{II} = 1 - \psi_{IH} = 1\)</span>. For analysing the house finch data, we allow recovering from the disease, and we will use transition matrix from previous slide.</p>
<p>Observation matrix</p>
<p><span class="math display">\[
\begin{matrix}
&amp; \\
\mathbf{\Omega} =
    \left ( \vphantom{ \begin{matrix} 12 \\ 12 \\ 12\end{matrix} } \right .
\end{matrix}
\hspace{-1.2em}
\begin{matrix}
    y_t=0 &amp; y_t=1 &amp; y_t=2 &amp; y_t=3\\ \hdashline
1-p_H &amp; p_H \beta_H &amp; 0 &amp; p_H (1-\beta_H)\\
1-p_I &amp; 0 &amp; p_{I} \beta_{I} &amp; p_{I} (1-\beta_{I})\\
1 &amp; 0 &amp; 0 &amp; 0
\end{matrix}
\hspace{-0.2em}
\begin{matrix}
&amp; \\
\left . \vphantom{ \begin{matrix} 12 \\ 12 \\ 12\end{matrix} } \right )
    \begin{matrix}
    z_{t}=H \\ z_{t}=I \\ z_{t}=D
    \end{matrix}
\end{matrix}
\]</span></p>
<p><span class="math inline">\(\beta_H\)</span> is the probability to assign a healthy individual to state H. <span class="math inline">\(\beta_{I}\)</span> is the probability to assign a sick individual to state I. <span class="math inline">\(p_H\)</span> is the detection probability of healthy individuals, <span class="math inline">\(p_I\)</span> that of sick individuals.</p>
</div>
<div id="results-1" class="section level3" number="8.3.4">
<h3>
<span class="header-section-number">8.3.4</span> Results<a class="anchor" aria-label="anchor" href="#results-1"><i class="fas fa-link"></i></a>
</h3>
<pre><code>##       mean   sd 2.5%  50% 97.5% Rhat n.eff
## betaH 0.99 0.01 0.97 0.99  1.00 1.01  1421
## betaI 0.05 0.01 0.03 0.05  0.08 1.00  6477
## pH    0.17 0.02 0.13 0.17  0.22 1.01   331
## pI    0.58 0.10 0.41 0.57  0.80 1.04   220
## phiH  0.88 0.02 0.84 0.88  0.92 1.01   360
## phiI  0.99 0.01 0.96 0.99  1.00 1.00  1004
## pi    0.96 0.01 0.93 0.96  0.98 1.00  4190
## psiHI 0.22 0.04 0.16 0.22  0.32 1.02   311
## psiIH 0.46 0.08 0.32 0.45  0.63 1.02   392</code></pre>
<p>Healthy individuals are correctly assigned, while infected individuals are difficult to ascertain. Sounds like being infected has an effect on detection and survival. Run models without effects and compare with WAIC for formal testing. Infection rate is 22%, recovery rate is 46%.</p>
<div class="inline-figure"><img src="banana-book_files/figure-html/unnamed-chunk-280-1.png" width="672"></div>
</div>
</div>
<div id="individual-heterogeneity-with-finite-mixtures." class="section level2" number="8.4">
<h2>
<span class="header-section-number">8.4</span> Individual heterogeneity with finite mixtures.<a class="anchor" aria-label="anchor" href="#individual-heterogeneity-with-finite-mixtures."><i class="fas fa-link"></i></a>
</h2>
<p>Our last example is about individual heterogeneity and how to account for it with HMMs. Gray wolf is a social species with hierarchy in packs which may reflect in species demography. As an example, we’ll work with gray wolves.</p>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="st">"images/wolfdominance.jpg"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="images/wolfdominance.jpg" width="450"></div>
<p>Gray wolf is a social species with hierarchy in packs which may reflect in demography. Shirley Pledger in a series of papers developed heterogeneity models in which individuals are assigned in two or more classes with class-specific survival/detection probabilities. <a href="https://conbio.onlinelibrary.wiley.com/doi/abs/10.1111/j.1523-1739.2009.01431.x">Cubaynes et al. (2010)</a> used HMMs to account for heterogeneity in the detection process due to social status, see also <a href="https://link.springer.com/chapter/10.1007%2F978-0-387-78151-8_36">Pradel et al. (2009)</a>. Dominant individuals tend to use path more often than others, and these paths are where we look for scats.</p>
<div id="individual-heterogeneity" class="section level3" number="8.4.1">
<h3>
<span class="header-section-number">8.4.1</span> Individual heterogeneity<a class="anchor" aria-label="anchor" href="#individual-heterogeneity"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>3 states
<ul>
<li>alive in class 1 (A1)</li>
<li>alive in class 2 (A2)</li>
<li>dead (D)</li>
</ul>
</li>
<li>4 observations
<ul>
<li>not captured (0)</li>
<li>captured (1)</li>
</ul>
</li>
</ul>
</div>
<div id="hmm-model-for-individual-heterogeneity" class="section level3" number="8.4.2">
<h3>
<span class="header-section-number">8.4.2</span> HMM model for individual heterogeneity<a class="anchor" aria-label="anchor" href="#hmm-model-for-individual-heterogeneity"><i class="fas fa-link"></i></a>
</h3>
<p>Vector of initial state probabilities</p>
<p><span class="math display">\[
\begin{matrix}
&amp; \\
\mathbf{\delta} =
    \left ( \vphantom{ \begin{matrix} 12 \end{matrix} } \right .
\end{matrix}
\hspace{-1.2em}
\begin{matrix}
    z_t=A1 &amp; z_t=A2 &amp; z_t=D \\ \hdashline
\pi &amp; 1 - \pi &amp; 0\\
\end{matrix}
\hspace{-0.2em}
\begin{matrix}
&amp; \\
\left . \vphantom{ \begin{matrix} 12 \end{matrix} } \right )
    \begin{matrix}
    \end{matrix}
\end{matrix}
\]</span></p>
<p><span class="math inline">\(\pi\)</span> is the probability of being alive in class 1. <span class="math inline">\(1 - \pi\)</span> is the probability of being in class 2.</p>
</div>
<div id="hmm-model-for-individual-heterogeneity-1" class="section level3" number="8.4.3">
<h3>
<span class="header-section-number">8.4.3</span> HMM model for individual heterogeneity<a class="anchor" aria-label="anchor" href="#hmm-model-for-individual-heterogeneity-1"><i class="fas fa-link"></i></a>
</h3>
<p>Transition matrix</p>
<p><span class="math display">\[
\begin{matrix}
&amp; \\
\mathbf{\Gamma} =
    \left ( \vphantom{ \begin{matrix} 12 \\ 12 \\ 12 \end{matrix} } \right .
\end{matrix}
\hspace{-1.2em}
\begin{matrix}
    z_t=A1 &amp; z_t=A2 &amp; z_t=D \\ \hdashline
\phi  &amp; 0 &amp; 1 - \phi\\
0 &amp; \phi &amp; 1 - \phi\\
0 &amp; 0 &amp; 1
\end{matrix}
\hspace{-0.2em}
\begin{matrix}
&amp; \\
\left . \vphantom{ \begin{matrix} 12 \\ 12 \\ 12 \end{matrix} } \right )
    \begin{matrix}
    z_{t-1}=A1 \\ z_{t-1}=A2 \\ z_{t-1}=D
    \end{matrix}
\end{matrix}
\]</span></p>
<p><span class="math inline">\(\phi\)</span> is the survival probability, which could be made heterogeneous.</p>
<p>Transition matrix, with change in heterogeneity class</p>
<p><span class="math display">\[
\begin{matrix}
&amp; \\
\mathbf{\Gamma} =
    \left ( \vphantom{ \begin{matrix} 12 \\ 12 \\ 12 \end{matrix} } \right .
\end{matrix}
\hspace{-1.2em}
\begin{matrix}
    z_t=A1 &amp; z_t=A2 &amp; z_t=D \\ \hdashline
\phi (1-\psi_{12}) &amp; \phi \psi_{12} &amp; 1 - \phi\\
\phi \psi_{21} &amp; \phi (1-\psi_{21}) &amp; 1 - \phi\\
0 &amp; 0 &amp; 1
\end{matrix}
\hspace{-0.2em}
\begin{matrix}
&amp; \\
\left . \vphantom{ \begin{matrix} 12 \\ 12 \\ 12 \end{matrix} } \right )
    \begin{matrix}
    z_{t-1}=A1 \\ z_{t-1}=A2 \\ z_{t-1}=D
    \end{matrix}
\end{matrix}
\]</span></p>
<p><span class="math inline">\(\psi_{12}\)</span> is the probability for an individual to change class of heterogeneity, from 1 to 2. <span class="math inline">\(\psi_{21}\)</span> is the probability for an individual to change class of heterogeneity, from 2 to 1.</p>
<p>Observation matrix</p>
<p><span class="math display">\[
\begin{matrix}
&amp; \\
\mathbf{\Omega} =
    \left ( \vphantom{ \begin{matrix} 12 \\ 12 \\ 12\end{matrix} } \right .
\end{matrix}
\hspace{-1.2em}
\begin{matrix}
    y_t=0 &amp; y_t=1\\ \hdashline
1 - p_1 &amp; p_1\\
1 - p_2 &amp; p_2\\
1 &amp; 0
\end{matrix}
\hspace{-0.2em}
\begin{matrix}
&amp; \\
\left . \vphantom{ \begin{matrix} 12 \\ 12 \\ 12\end{matrix} } \right )
    \begin{matrix}
    z_{t}=A1 \\ z_{t}=A2 \\ z_{t}=D
    \end{matrix}
\end{matrix}
\]</span></p>
<p><span class="math inline">\(p_1\)</span> is detection for individuals in class 1, and <span class="math inline">\(p_2\)</span> that of individuals in class 2.</p>
</div>
<div id="results-2" class="section level3" number="8.4.4">
<h3>
<span class="header-section-number">8.4.4</span> Results<a class="anchor" aria-label="anchor" href="#results-2"><i class="fas fa-link"></i></a>
</h3>
<pre><code>##     mean   sd 2.5%  50% 97.5% Rhat n.eff
## p1  0.38 0.09 0.23 0.38  0.56 1.04   210
## p2  0.50 0.12 0.25 0.50  0.73 1.01   229
## phi 0.81 0.05 0.71 0.81  0.91 1.04   317
## pi  0.62 0.12 0.36 0.63  0.83 1.02   164</code></pre>
<p>We have lowly detectable individuals (class A1 with <span class="math inline">\(p_1\)</span>) in proportion 62%. And highly (or so) detectable individuals (class A2 with <span class="math inline">\(p_2\)</span>) in proportion 38%. Note that interpretation of classes is made a posteriori. Survival is 81%.</p>
<div class="inline-figure"><img src="banana-book_files/figure-html/unnamed-chunk-283-1.png" width="672"></div>
<p>You may consider more classes, and select among models, see <a href="https://oliviergimenez.github.io/pubs/Cubaynesetal2011MEE.pdf">Cubaynes et al. (2012)</a>. You may also go for a non-parametric approach and let the data tell you how many classes you need. This is relatively easy to do in Nimble, see <a href="https://arxiv.org/abs/2007.10163">Turek et al. (2021)</a>. More about individual heterogeneity in <a href="https://oliviergimenez.github.io/pubs/GimenezCamGaillard2017Oikos.pdf">Gimenez et al. (2018)</a>.</p>
</div>
</div>
<div id="hmms-to-analyse-capture-recapture-data" class="section level2" number="8.5">
<h2>
<span class="header-section-number">8.5</span> HMMs to analyse capture-recapture data<a class="anchor" aria-label="anchor" href="#hmms-to-analyse-capture-recapture-data"><i class="fas fa-link"></i></a>
</h2>
<p>With the same data, ask further questions, just consider different states.</p>
<div id="how-to-make-our-models-remember" class="section level3" number="8.5.1">
<h3>
<span class="header-section-number">8.5.1</span> How to make our models remember?<a class="anchor" aria-label="anchor" href="#how-to-make-our-models-remember"><i class="fas fa-link"></i></a>
</h3>
<p>So far, the dynamics of the states are first-order Makovian. The site where you will be depends only on the site where you are, and not on the sites you were previously. How to relax this assumption, and go second-order Markovian?</p>
<p>Memory models were initially proposed by <a href="https://esajournals.onlinelibrary.wiley.com/doi/abs/10.2307/2937193">Hestbeck et al. (1991)</a> and <a href="https://www.jstor.org/stable/2532259?origin=crossref&amp;seq=1#metadata_info_tab_contents">Brownie et al. (1993)</a>, then formulated as HMMs in <a href="https://link.springer.com/article/10.1198/jabes.2009.06108">Rouan et al. (2009)</a>. See also <a href="https://onlinelibrary.wiley.com/doi/10.1002/ece3.1037">Cole et al. (2014)</a>.</p>
</div>
<div id="remember-hmm-model-for-dispersal-between-2-sites" class="section level3" number="8.5.2">
<h3>
<span class="header-section-number">8.5.2</span> Remember HMM model for dispersal between 2 sites<a class="anchor" aria-label="anchor" href="#remember-hmm-model-for-dispersal-between-2-sites"><i class="fas fa-link"></i></a>
</h3>
<p>Transition matrix</p>
<p><span class="math display">\[
\begin{matrix}
&amp; \\
\mathbf{\Gamma} =
    \left ( \vphantom{ \begin{matrix} 12 \\ 12 \\ 12 \end{matrix} } \right .
\end{matrix}
\hspace{-1.2em}
\begin{matrix}
    z_t=A &amp; z_t=B &amp; z_t=D \\ \hdashline
\phi_A (1-\psi_{AB}) &amp; \phi_A \psi_{AB} &amp; 1 - \phi_A\\
\phi_B \psi_{BA} &amp; \phi_B (1-\psi_{BA}) &amp; 1 - \phi_B\\
0 &amp; 0 &amp; 1
\end{matrix}
\hspace{-0.2em}
\begin{matrix}
&amp; \\
\left . \vphantom{ \begin{matrix} 12 \\ 12 \\ 12 \end{matrix} } \right )
    \begin{matrix}
    z_{t-1}=A \\ z_{t-1}=B \\ z_{t-1}=D
    \end{matrix}
\end{matrix}
\]</span></p>
<p>Observation matrix</p>
<p><span class="math display">\[
\begin{matrix}
&amp; \\
\mathbf{\Omega} =
    \left ( \vphantom{ \begin{matrix} 12 \\ 12 \\ 12 \end{matrix} } \right .
\end{matrix}
\hspace{-1.2em}
\begin{matrix}
    y_t=0 &amp; y_t=1 &amp; y_t=2 \\ \hdashline
1 - p_A &amp; p_A &amp; 0\\
1 - p_B &amp; 0 &amp; p_B\\
1 &amp; 0 &amp; 0
\end{matrix}
\hspace{-0.2em}
\begin{matrix}
&amp; \\
\left . \vphantom{ \begin{matrix} 12 \\ 12 \\ 12 \end{matrix} } \right )
    \begin{matrix}
    z_{t}=A \\ z_{t}=B \\ z_{t}=D
    \end{matrix}
\end{matrix}
\]</span></p>
</div>
<div id="hmm-formulation-of-the-memory-model" class="section level3" number="8.5.3">
<h3>
<span class="header-section-number">8.5.3</span> HMM formulation of the memory model<a class="anchor" aria-label="anchor" href="#hmm-formulation-of-the-memory-model"><i class="fas fa-link"></i></a>
</h3>
<p>To keep track of the sites previously visited, the trick is to consider states as being pairs of sites occupied</p>
<ul>
<li>States
<ul>
<li>AA is for alive in site A at <span class="math inline">\(t\)</span> and alive in site A at <span class="math inline">\(t-1\)</span>
</li>
<li>AB is for alive in site A at <span class="math inline">\(t\)</span> and alive in site B at <span class="math inline">\(t-1\)</span>
</li>
<li>BA is for alive in site B at <span class="math inline">\(t\)</span> and alive in site A at <span class="math inline">\(t-1\)</span>
</li>
<li>BB is for alive in site B at <span class="math inline">\(t\)</span> and alive in site B at <span class="math inline">\(t-1\)</span>
</li>
<li>D is for dead</li>
</ul>
</li>
<li>Observations
<ul>
<li>0 not captured</li>
<li>1 captured at site A</li>
<li>2 captured at site B</li>
</ul>
</li>
</ul>
<p>Vector of initial state probabilities</p>
<p><span class="math display">\[
\begin{matrix}
&amp; \\
\mathbf{\delta} =
    \left ( \vphantom{ \begin{matrix} 12 \end{matrix} } \right .
\end{matrix}
\hspace{-1.2em}
\begin{matrix}
    z_t=AA &amp; z_t=AB &amp; z_t=BA &amp; z_t=BB &amp;z_t=D \\ \hdashline
\pi_{AA} &amp; \pi_{AB} &amp; \pi_{BA} &amp; \pi_{BB} &amp; 0\\
\end{matrix}
\hspace{-0.2em}
\begin{matrix}
&amp; \\
\left . \vphantom{ \begin{matrix} 12 \end{matrix} } \right )
    \begin{matrix}
    \end{matrix}
\end{matrix}
\]</span></p>
<p>where <span class="math inline">\(\pi_{BB} = 1 - (\pi_{AA} + \pi_{AB} + \pi_{BA})\)</span>, and <span class="math inline">\(\pi_{ij}\)</span> at site <span class="math inline">\(j\)</span> when first captured at <span class="math inline">\(t\)</span> and site <span class="math inline">\(i\)</span> at <span class="math inline">\(t - 1\)</span>.</p>
<p>Transition matrix</p>
<p><span class="math display">\[
\begin{matrix}
&amp; \\
\mathbf{\Gamma} =
    \left ( \vphantom{ \begin{matrix} 12 \\ 12 \\ 12 \\ 12 \\ 12\end{matrix} } \right .
\end{matrix}
\hspace{-1.2em}
\begin{matrix}
    z_t=AA &amp; z_t=AB &amp; z_t=BA &amp; z_t=BB &amp; z_t=D \\ \hdashline
\phi_{AAA} &amp; \phi_{AAB} &amp; 0 &amp; 0 &amp; 1 - \phi_{AAA} - \phi_{AAB}\\
0 &amp; 0 &amp; \phi_{ABA} &amp; \phi_{ABB} &amp; 1 - \phi_{ABA} - \phi_{ABB}\\
\phi_{BAA} &amp; \phi_{BAB} &amp; 0 &amp; 0 &amp; 1 - \phi_{BAA} - \phi_{BAB}\\
0 &amp; 0 &amp; \phi_{BBA} &amp; \phi_{BBB} &amp; 1 - \phi_{BBA} - \phi_{BBB}\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1
\end{matrix}
\hspace{-0.2em}
\begin{matrix}
&amp; \\
\left . \vphantom{ \begin{matrix} 12 \\ 12 \\ 12 \\ 12 \\ 12\end{matrix} } \right )
    \begin{matrix}
    z_t=AA \\ z_t=AB \\ z_t=BA \\ z_t=BB \\ z_t=D
    \end{matrix}
\end{matrix}
\]</span></p>
<p><span class="math inline">\(\phi_{ijk}\)</span> is probability to be in site <span class="math inline">\(k\)</span> at time <span class="math inline">\(t + 1\)</span> for an individual
present in site <span class="math inline">\(j\)</span> at <span class="math inline">\(t\)</span> and in site <span class="math inline">\(i\)</span> at <span class="math inline">\(t - 1\)</span></p>
<p>Transition matrix, alternate parameterization</p>
<p><span class="math display">\[
\begin{matrix}
&amp; \\
\mathbf{\Gamma} =
    \left ( \vphantom{ \begin{matrix} 12 \\ 12 \\ 12 \\ 12 \\ 12\end{matrix} } \right .
\end{matrix}
\hspace{-1.2em}
\begin{matrix}
    z_t=AA &amp; z_t=AB &amp; z_t=BA &amp; z_t=BB &amp; z_t=D \\ \hdashline
\phi \psi_{AAA} &amp; \phi (1 - \psi_{AAA}) &amp; 0 &amp; 0 &amp; 1 - \phi\\
0 &amp; 0 &amp; \phi (1 - \psi_{ABB}) &amp; \phi \psi_{ABB} &amp; 1 - \phi\\
\phi \psi_{BAA} &amp; \phi (1 - \psi_{BAA}) &amp; 0 &amp; 0 &amp; 1 - \phi\\
0 &amp; 0 &amp; \phi (1-\psi_{BBB}) &amp; \phi \psi_{BBB} &amp; 1 - \phi\\
0 &amp; 0 &amp; 0 &amp; 0 &amp; 1
\end{matrix}
\hspace{-0.2em}
\begin{matrix}
&amp; \\
\left . \vphantom{ \begin{matrix} 12 \\ 12 \\ 12 \\ 12 \\ 12\end{matrix} } \right )
    \begin{matrix}
    z_t=AA \\ z_t=AB \\ z_t=BA \\ z_t=BB \\ z_t=D
    \end{matrix}
\end{matrix}
\]</span></p>
<p><span class="math inline">\(\phi\)</span> is the probability of surviving from one occasion to the next. <span class="math inline">\(\psi_{ijj}\)</span> is the probability an animal stays at the same site <span class="math inline">\(j\)</span> given that it was at site <span class="math inline">\(i\)</span> on the previous occasion.</p>
<p>Observation matrix</p>
<p><span class="math display">\[
\begin{matrix}
&amp; \\
\mathbf{\Omega} =
    \left ( \vphantom{ \begin{matrix} 12 \\ 12 \\ 12 \\ 12 \\ 12\end{matrix} } \right .
\end{matrix}
\hspace{-1.2em}
\begin{matrix}
    y_t=0 &amp; y_t=1 &amp; y_t=2 \\ \hdashline
1 - p_A &amp; p_A &amp; 0\\
1 - p_B &amp; 0 &amp; p_B\\
1 - p_A &amp; p_A &amp; 0\\
1 - p_B &amp; 0 &amp; p_B\\
1 &amp; 0 &amp; 0
\end{matrix}
\hspace{-0.2em}
\begin{matrix}
&amp; \\
\left . \vphantom{ \begin{matrix} 12 \\ 12 \\ 12 \\ 12 \\ 12\end{matrix} } \right )
    \begin{matrix}
    z_t=AA \\ z_t=AB \\ z_t=BA \\ z_t=BB \\ z_t=D
    \end{matrix}
\end{matrix}
\]</span></p>
</div>
</div>
<div id="summary-5" class="section level2" number="8.6">
<h2>
<span class="header-section-number">8.6</span> Summary<a class="anchor" aria-label="anchor" href="#summary-5"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p>Blabla.</p></li>
<li><p>Blabla.</p></li>
</ul>
</div>
<div id="suggested-reading-5" class="section level2" number="8.7">
<h2>
<span class="header-section-number">8.7</span> Suggested reading<a class="anchor" aria-label="anchor" href="#suggested-reading-5"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li><p>Seminal paper by Pradel (2005) <a href="https://onlinelibrary.wiley.com/doi/abs/10.1111/j.1541-0420.2005.00318.x">Multievent: An Extension of Multistate Capture–Recapture Models to Uncertain States</a>. Biometrics, 61: 442-447.</p></li>
<li><p>Dupuis (1995) had a similar idea for the Arnason-Schwarz model: Dupuis, J. (1995) <a href="https://academic.oup.com/biomet/article-abstract/82/4/761/252161">Bayesian estimation of movement and survival probabilities from capture-recapture data</a>. Biometrika. Vol. 82, pp 761-772.</p></li>
<li><p>See also for a review Gimenez et al. (2012) <a href="https://oliviergimenez.github.io/pubs/Gimenezetal2012TPB.pdf">Estimating demographic parameters using hidden process dynamic models</a>. Theoretical Population Biology 82: 307-316.</p></li>
</ul>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="introduction-7.html">Introduction</a></div>
<div class="next"><a href="hsmm.html"><span class="header-section-number">9</span> Hidden semi-Markov models</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#uncertainty"><span class="header-section-number">8</span> State uncertainty</a></li>
<li><a class="nav-link" href="#introduction-8"><span class="header-section-number">8.1</span> Introduction</a></li>
<li>
<a class="nav-link" href="#uncertainty-in-breeding-status-sooty-shearwater-david-boyle"><span class="header-section-number">8.2</span> Uncertainty in breeding status: Sooty shearwater (David Boyle)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ingredients"><span class="header-section-number">8.2.1</span> Ingredients</a></li>
<li><a class="nav-link" href="#how-states-generate-observations"><span class="header-section-number">8.2.2</span> How states generate observations</a></li>
<li><a class="nav-link" href="#hmm-model-for-breeding-states-with-uncertainty"><span class="header-section-number">8.2.3</span> HMM model for breeding states with uncertainty</a></li>
<li><a class="nav-link" href="#our-model-phi_b-phi_nb-psi_bnb-psi_nbb-p_b-p_nb-beta_b-beta_nb-pi"><span class="header-section-number">8.2.4</span> Our model \((\phi_B, \phi_{NB}, \psi_{BNB}, \psi_{NBB}, p_B, p_{NB}, \beta_B, \beta_{NB}, \pi)\)</a></li>
<li><a class="nav-link" href="#results"><span class="header-section-number">8.2.5</span> Results</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#animal-epidemiology-with-uncertain-disease-states"><span class="header-section-number">8.3</span> Animal epidemiology with uncertain disease states</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#states-and-observations"><span class="header-section-number">8.3.1</span> States and observations</a></li>
<li><a class="nav-link" href="#how-states-generate-observations."><span class="header-section-number">8.3.2</span> How states generate observations.</a></li>
<li><a class="nav-link" href="#hmm-model-for-disease-states-with-uncertainty"><span class="header-section-number">8.3.3</span> HMM model for disease states with uncertainty</a></li>
<li><a class="nav-link" href="#results-1"><span class="header-section-number">8.3.4</span> Results</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#individual-heterogeneity-with-finite-mixtures."><span class="header-section-number">8.4</span> Individual heterogeneity with finite mixtures.</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#individual-heterogeneity"><span class="header-section-number">8.4.1</span> Individual heterogeneity</a></li>
<li><a class="nav-link" href="#hmm-model-for-individual-heterogeneity"><span class="header-section-number">8.4.2</span> HMM model for individual heterogeneity</a></li>
<li><a class="nav-link" href="#hmm-model-for-individual-heterogeneity-1"><span class="header-section-number">8.4.3</span> HMM model for individual heterogeneity</a></li>
<li><a class="nav-link" href="#results-2"><span class="header-section-number">8.4.4</span> Results</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#hmms-to-analyse-capture-recapture-data"><span class="header-section-number">8.5</span> HMMs to analyse capture-recapture data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#how-to-make-our-models-remember"><span class="header-section-number">8.5.1</span> How to make our models remember?</a></li>
<li><a class="nav-link" href="#remember-hmm-model-for-dispersal-between-2-sites"><span class="header-section-number">8.5.2</span> Remember HMM model for dispersal between 2 sites</a></li>
<li><a class="nav-link" href="#hmm-formulation-of-the-memory-model"><span class="header-section-number">8.5.3</span> HMM formulation of the memory model</a></li>
</ul>
</li>
<li><a class="nav-link" href="#summary-5"><span class="header-section-number">8.6</span> Summary</a></li>
<li><a class="nav-link" href="#suggested-reading-5"><span class="header-section-number">8.7</span> Suggested reading</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/oliviergimenez/banana-book/blob/master/uncertainty.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/oliviergimenez/banana-book/edit/master/uncertainty.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Bayesian Analysis of Capture-Recapture Data with Hidden Markov Models</strong>: Theory and Case Studies in R" was written by Olivier Gimenez. It was last built on 2022-03-05.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>

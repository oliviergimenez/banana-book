<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="1.4 Programming | Bayesian Analysis of Capture-Recapture Data with Hidden Markov Models" />
<meta property="og:type" content="book" />

<meta property="og:description" content="This is a textbook on the analysis of capture-recapture data with hidden Markov models (HMM) implemented in the Bayesian framework with R." />
<meta name="github-repo" content="oliviergimenez/banana-book" />

<meta name="author" content="Olivier Gimenez" />

<meta name="date" content="2022-12-23" />


<meta name="description" content="This is a textbook on the analysis of capture-recapture data with hidden Markov models (HMM) implemented in the Bayesian framework with R.">

<title>1.4 Programming | Bayesian Analysis of Capture-Recapture Data with Hidden Markov Models</title>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
/* show arrow before summary tag as in bootstrap
TODO: remove if boostrap in updated in html_document (rmarkdown#1485) */
details > summary {
  display: list-item;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="container-fluid main-container">


<div class="row">
<div class="col-sm-12">
<div id="TOC">
<ul>
<li class="has-sub"><a href="index.html#welcome" id="toc-welcome">Welcome</a>
<ul>
<li><a href="license.html#license" id="toc-license">License</a></li>
</ul></li>
<li class="has-sub"><a href="preface.html#preface" id="toc-preface">Preface</a>
<ul>
<li><a href="why-this-book.html#why-this-book" id="toc-why-this-book">Why this book?</a></li>
<li><a href="who-should-read-this-book.html#who-should-read-this-book" id="toc-who-should-read-this-book">Who should read this book?</a></li>
<li><a href="what-will-you-learn.html#what-will-you-learn" id="toc-what-will-you-learn">What will you learn?</a></li>
<li><a href="what-wont-you-learn.html#what-wont-you-learn" id="toc-what-wont-you-learn">What won’t you learn?</a></li>
<li><a href="prerequisites.html#prerequisites" id="toc-prerequisites">Prerequisites</a></li>
<li><a href="acknowledgements.html#acknowledgements" id="toc-acknowledgements">Acknowledgements</a></li>
<li><a href="how-this-book-was-written.html#how-this-book-was-written" id="toc-how-this-book-was-written">How this book was written</a></li>
</ul></li>
<li><a href="about-the-author.html#about-the-author" id="toc-about-the-author">About the author</a></li>
<li class="part"><span><b>I I. Fundations</b></span></li>
<li><a href="introduction.html#introduction" id="toc-introduction">Introduction</a></li>
<li class="has-sub"><a href="1-intronimble.html#intronimble" id="toc-intronimble"><span class="toc-section-number">1</span> NIMBLE tutorial</a>
<ul>
<li><a href="1.1-introduction-1.html#introduction-1" id="toc-introduction-1"><span class="toc-section-number">1.1</span> Introduction</a></li>
<li><a href="1.2-what-is-nimble.html#what-is-nimble" id="toc-what-is-nimble"><span class="toc-section-number">1.2</span> What is NIMBLE?</a></li>
<li><a href="1.3-start-nimble.html#start-nimble" id="toc-start-nimble"><span class="toc-section-number">1.3</span> Getting started</a></li>
<li class="has-sub"><a href="1.4-functions-in-nimble.html#functions-in-nimble" id="toc-functions-in-nimble"><span class="toc-section-number">1.4</span> Programming</a>
<ul>
<li><a href="1.4-functions-in-nimble.html#nimble-functions" id="toc-nimble-functions"><span class="toc-section-number">1.4.1</span> NIMBLE functions</a></li>
<li><a href="1.4-functions-in-nimble.html#callrfninnimble" id="toc-callrfninnimble"><span class="toc-section-number">1.4.2</span> Calling R/C++ functions</a></li>
<li><a href="1.4-functions-in-nimble.html#user-defined-distributions" id="toc-user-defined-distributions"><span class="toc-section-number">1.4.3</span> User-defined distributions</a></li>
</ul></li>
<li><a href="1.5-under-the-hood.html#under-the-hood" id="toc-under-the-hood"><span class="toc-section-number">1.5</span> Under the hood</a></li>
<li class="has-sub"><a href="1.6-mcmc-samplers.html#mcmc-samplers" id="toc-mcmc-samplers"><span class="toc-section-number">1.6</span> MCMC samplers</a>
<ul>
<li><a href="1.6-mcmc-samplers.html#change-sampler" id="toc-change-sampler"><span class="toc-section-number">1.6.1</span> Default samplers</a></li>
<li><a href="1.6-mcmc-samplers.html#user-defined-samplers" id="toc-user-defined-samplers"><span class="toc-section-number">1.6.2</span> User-defined samplers</a></li>
</ul></li>
<li class="has-sub"><a href="1.7-tips-and-tricks.html#tips-and-tricks" id="toc-tips-and-tricks"><span class="toc-section-number">1.7</span> Tips and tricks</a>
<ul>
<li><a href="1.7-tips-and-tricks.html#precision-vs-standard-deviation" id="toc-precision-vs-standard-deviation"><span class="toc-section-number">1.7.1</span> Precision vs standard deviation</a></li>
<li><a href="1.7-tips-and-tricks.html#indexing" id="toc-indexing"><span class="toc-section-number">1.7.2</span> Indexing</a></li>
<li><a href="1.7-tips-and-tricks.html#faster-compilation" id="toc-faster-compilation"><span class="toc-section-number">1.7.3</span> Faster compilation</a></li>
<li><a href="1.7-tips-and-tricks.html#updating-mcmc-chains" id="toc-updating-mcmc-chains"><span class="toc-section-number">1.7.4</span> Updating MCMC chains</a></li>
<li><a href="1.7-tips-and-tricks.html#reproducibility" id="toc-reproducibility"><span class="toc-section-number">1.7.5</span> Reproducibility</a></li>
<li><a href="1.7-tips-and-tricks.html#parallelization" id="toc-parallelization"><span class="toc-section-number">1.7.6</span> Parallelization</a></li>
<li><a href="1.7-tips-and-tricks.html#incomplete-initialization" id="toc-incomplete-initialization"><span class="toc-section-number">1.7.7</span> Incomplete initialization</a></li>
<li><a href="1.7-tips-and-tricks.html#vectorization" id="toc-vectorization"><span class="toc-section-number">1.7.8</span> Vectorization</a></li>
</ul></li>
<li><a href="1.8-summary.html#summary" id="toc-summary"><span class="toc-section-number">1.8</span> Summary</a></li>
<li><a href="1.9-suggested-reading.html#suggested-reading" id="toc-suggested-reading"><span class="toc-section-number">1.9</span> Suggested reading</a></li>
</ul></li>
<li><a href="faq.html#faq" id="toc-faq">FAQ</a></li>
<li><a href="references.html#references" id="toc-references">References</a></li>
</ul>
</div>
</div>
</div>
<div class="row">
<div class="col-sm-12">
<div id="functions-in-nimble" class="section level2" number="1.4">
<h2><span class="header-section-number">1.4</span> Programming</h2>
<p>In NIMBLE you can write and use your own functions, or use existing R or C/C++ functions. This allows you to customize models the way you want.</p>
<div id="nimble-functions" class="section level3" number="1.4.1">
<h3><span class="header-section-number">1.4.1</span> NIMBLE functions</h3>
<p>NIMBLE provides <code>nimbleFunctions</code> for programming. A <code>nimbleFunction</code> is like an R function, plus it can be compiled for faster computation. Going back to our animal survival example, we can write a <code>nimbleFunction</code> to compute lifespan:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="1.4-functions-in-nimble.html#cb26-1" aria-hidden="true" tabindex="-1"></a>computeLifespan <span class="ot">&lt;-</span> <span class="fu">nimbleFunction</span>(</span>
<span id="cb26-2"><a href="1.4-functions-in-nimble.html#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">run =</span> <span class="cf">function</span>(<span class="at">theta =</span> <span class="fu">double</span>(<span class="dv">0</span>)) { <span class="co"># type declarations</span></span>
<span id="cb26-3"><a href="1.4-functions-in-nimble.html#cb26-3" aria-hidden="true" tabindex="-1"></a>        ans <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">log</span>(theta)</span>
<span id="cb26-4"><a href="1.4-functions-in-nimble.html#cb26-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">return</span>(ans)</span>
<span id="cb26-5"><a href="1.4-functions-in-nimble.html#cb26-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">returnType</span>(<span class="fu">double</span>(<span class="dv">0</span>))  <span class="co"># return type declaration</span></span>
<span id="cb26-6"><a href="1.4-functions-in-nimble.html#cb26-6" aria-hidden="true" tabindex="-1"></a>    } )</span></code></pre></div>
<p>Within the nimbleFunction, the <code>run</code> section gives the function to be executed. It is written in the NIMBLE language. The <code>theta = double(0)</code> and <code>returnType(double(0))</code> arguments tell NIMBLE that the input and output are single numeric values (scalars). Alternatively, <code>double(1)</code> and <code>double(2)</code> are for vectors and matrices, while <code>logical()</code>, <code>integer()</code> and <code>character()</code> are for logical, integer and character values.</p>
<p>You can use your <code>nimbleFunction</code> in R:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="1.4-functions-in-nimble.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">computeLifespan</span>(<span class="fl">0.8</span>)</span>
<span id="cb27-2"><a href="1.4-functions-in-nimble.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 4.481</span></span></code></pre></div>
<p>You can compile it and use the C++ code for faster computation:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="1.4-functions-in-nimble.html#cb28-1" aria-hidden="true" tabindex="-1"></a>CcomputeLifespan <span class="ot">&lt;-</span> <span class="fu">compileNimble</span>(computeLifespan)</span>
<span id="cb28-2"><a href="1.4-functions-in-nimble.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">CcomputeLifespan</span>(<span class="fl">0.8</span>)</span>
<span id="cb28-3"><a href="1.4-functions-in-nimble.html#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 4.481</span></span></code></pre></div>
<p>You can also use your <code>nimbleFunction</code> in a model:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="1.4-functions-in-nimble.html#cb29-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">nimbleCode</span>({</span>
<span id="cb29-2"><a href="1.4-functions-in-nimble.html#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># likelihood</span></span>
<span id="cb29-3"><a href="1.4-functions-in-nimble.html#cb29-3" aria-hidden="true" tabindex="-1"></a>  survived <span class="sc">~</span> <span class="fu">dbinom</span>(theta, released)</span>
<span id="cb29-4"><a href="1.4-functions-in-nimble.html#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prior</span></span>
<span id="cb29-5"><a href="1.4-functions-in-nimble.html#cb29-5" aria-hidden="true" tabindex="-1"></a>  theta <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb29-6"><a href="1.4-functions-in-nimble.html#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># derived quantity</span></span>
<span id="cb29-7"><a href="1.4-functions-in-nimble.html#cb29-7" aria-hidden="true" tabindex="-1"></a>  lifespan <span class="ot">&lt;-</span> <span class="fu">computeLifespan</span>(theta)</span>
<span id="cb29-8"><a href="1.4-functions-in-nimble.html#cb29-8" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>The rest of the workflow remains the same:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="1.4-functions-in-nimble.html#cb30-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">survived =</span> <span class="dv">19</span>, <span class="at">released =</span> <span class="dv">57</span>)</span>
<span id="cb30-2"><a href="1.4-functions-in-nimble.html#cb30-2" aria-hidden="true" tabindex="-1"></a>parameters.to.save <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;theta&quot;</span>, <span class="st">&quot;lifespan&quot;</span>)</span>
<span id="cb30-3"><a href="1.4-functions-in-nimble.html#cb30-3" aria-hidden="true" tabindex="-1"></a>initial.values <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">list</span>(<span class="at">theta =</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb30-4"><a href="1.4-functions-in-nimble.html#cb30-4" aria-hidden="true" tabindex="-1"></a>n.iter <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb30-5"><a href="1.4-functions-in-nimble.html#cb30-5" aria-hidden="true" tabindex="-1"></a>n.burnin <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb30-6"><a href="1.4-functions-in-nimble.html#cb30-6" aria-hidden="true" tabindex="-1"></a>n.chains <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb30-7"><a href="1.4-functions-in-nimble.html#cb30-7" aria-hidden="true" tabindex="-1"></a>mcmc.output <span class="ot">&lt;-</span> <span class="fu">nimbleMCMC</span>(<span class="at">code =</span> model,</span>
<span id="cb30-8"><a href="1.4-functions-in-nimble.html#cb30-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> my.data,</span>
<span id="cb30-9"><a href="1.4-functions-in-nimble.html#cb30-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">inits =</span> initial.values,</span>
<span id="cb30-10"><a href="1.4-functions-in-nimble.html#cb30-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">monitors =</span> parameters.to.save,</span>
<span id="cb30-11"><a href="1.4-functions-in-nimble.html#cb30-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">niter =</span> n.iter,</span>
<span id="cb30-12"><a href="1.4-functions-in-nimble.html#cb30-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">nburnin =</span> n.burnin,</span>
<span id="cb30-13"><a href="1.4-functions-in-nimble.html#cb30-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">nchains =</span> n.chains)</span>
<span id="cb30-14"><a href="1.4-functions-in-nimble.html#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="do">## |-------------|-------------|-------------|-------------|</span></span>
<span id="cb30-15"><a href="1.4-functions-in-nimble.html#cb30-15" aria-hidden="true" tabindex="-1"></a><span class="do">## |-------------------------------------------------------|</span></span>
<span id="cb30-16"><a href="1.4-functions-in-nimble.html#cb30-16" aria-hidden="true" tabindex="-1"></a><span class="do">## |-------------|-------------|-------------|-------------|</span></span>
<span id="cb30-17"><a href="1.4-functions-in-nimble.html#cb30-17" aria-hidden="true" tabindex="-1"></a><span class="do">## |-------------------------------------------------------|</span></span>
<span id="cb30-18"><a href="1.4-functions-in-nimble.html#cb30-18" aria-hidden="true" tabindex="-1"></a><span class="do">## |-------------|-------------|-------------|-------------|</span></span>
<span id="cb30-19"><a href="1.4-functions-in-nimble.html#cb30-19" aria-hidden="true" tabindex="-1"></a><span class="do">## |-------------------------------------------------------|</span></span>
<span id="cb30-20"><a href="1.4-functions-in-nimble.html#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="fu">MCMCsummary</span>(<span class="at">object =</span> mcmc.output, <span class="at">round =</span> <span class="dv">2</span>)</span>
<span id="cb30-21"><a href="1.4-functions-in-nimble.html#cb30-21" aria-hidden="true" tabindex="-1"></a><span class="do">##          mean   sd 2.5%  50% 97.5% Rhat n.eff</span></span>
<span id="cb30-22"><a href="1.4-functions-in-nimble.html#cb30-22" aria-hidden="true" tabindex="-1"></a><span class="do">## lifespan 0.94 0.16 0.68 0.92  1.29    1  2722</span></span>
<span id="cb30-23"><a href="1.4-functions-in-nimble.html#cb30-23" aria-hidden="true" tabindex="-1"></a><span class="do">## theta    0.34 0.06 0.23 0.34  0.46    1  2718</span></span></code></pre></div>
<p>With <code>nimbleFunctions</code>, you can mimic basic R syntax, do linear algebra (e.g. compute eigenvalues), operate on vectors and matrices (e.g. inverse a matrix), use logical operators (e.g. and/or) and flow control (e.g. if-else). There is also a long list of common and less common distributions that can be used with <code>nimbleFunctions</code>.</p>
<p>To learn everything you need to know on writing <code>nimbleFunctions</code>, make sure to read chapter 11 of the NIMBLE manual at <a href="https://r-nimble.org/html_manual/cha-RCfunctions.html#cha-RCfunctions" class="uri">https://r-nimble.org/html_manual/cha-RCfunctions.html#cha-RCfunctions</a>.</p>
</div>
<div id="callrfninnimble" class="section level3" number="1.4.2">
<h3><span class="header-section-number">1.4.2</span> Calling R/C++ functions</h3>
<p>If you’re like me, and too lazy to write your own functions, you can rely on the scientific community and use existing C, C++ or R code. The trick is to write a <code>nimbleFunction</code> that wraps access to that code which can then be used by NIMBLE. As an example, imagine you’d like to use an R function <code>myfunction()</code>, either a function you wrote yourself, or a function available in your favorite R package:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="1.4-functions-in-nimble.html#cb31-1" aria-hidden="true" tabindex="-1"></a>myfunction <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb31-2"><a href="1.4-functions-in-nimble.html#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span><span class="fu">log</span>(x)</span>
<span id="cb31-3"><a href="1.4-functions-in-nimble.html#cb31-3" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now wrap this function using <code>nimbleRcall()</code> or <code>nimbleExternalCall()</code> for a C or C++ function:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="1.4-functions-in-nimble.html#cb32-1" aria-hidden="true" tabindex="-1"></a>Rmyfunction <span class="ot">&lt;-</span> <span class="fu">nimbleRcall</span>(<span class="at">prototype =</span> <span class="cf">function</span>(<span class="at">x =</span> <span class="fu">double</span>(<span class="dv">0</span>)){}, </span>
<span id="cb32-2"><a href="1.4-functions-in-nimble.html#cb32-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">Rfun =</span> <span class="st">&#39;myfunction&#39;</span>,</span>
<span id="cb32-3"><a href="1.4-functions-in-nimble.html#cb32-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">returnType =</span> <span class="fu">double</span>(<span class="dv">0</span>))</span></code></pre></div>
<p>In the call to <code>nimbleRcall()</code> above, the argument <code>prototype</code> specifies inputs (a single numeric value <code>double(0)</code>) of the R function <code>Rfun</code> that generates outputs <code>returnType</code> (a single numeric value <code>double(0)</code>).</p>
<p>Now you can call your R function from a model (or any <code>nimbleFunctions</code>):</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="1.4-functions-in-nimble.html#cb33-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">nimbleCode</span>({</span>
<span id="cb33-2"><a href="1.4-functions-in-nimble.html#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># likelihood</span></span>
<span id="cb33-3"><a href="1.4-functions-in-nimble.html#cb33-3" aria-hidden="true" tabindex="-1"></a>  survived <span class="sc">~</span> <span class="fu">dbinom</span>(theta, released)</span>
<span id="cb33-4"><a href="1.4-functions-in-nimble.html#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># prior</span></span>
<span id="cb33-5"><a href="1.4-functions-in-nimble.html#cb33-5" aria-hidden="true" tabindex="-1"></a>  theta <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb33-6"><a href="1.4-functions-in-nimble.html#cb33-6" aria-hidden="true" tabindex="-1"></a>  lifespan <span class="ot">&lt;-</span> <span class="fu">Rmyfunction</span>(theta)</span>
<span id="cb33-7"><a href="1.4-functions-in-nimble.html#cb33-7" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>The rest of the workflow remains the same:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="1.4-functions-in-nimble.html#cb34-1" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">survived =</span> <span class="dv">19</span>, <span class="at">released =</span> <span class="dv">57</span>)</span>
<span id="cb34-2"><a href="1.4-functions-in-nimble.html#cb34-2" aria-hidden="true" tabindex="-1"></a>parameters.to.save <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;theta&quot;</span>, <span class="st">&quot;lifespan&quot;</span>)</span>
<span id="cb34-3"><a href="1.4-functions-in-nimble.html#cb34-3" aria-hidden="true" tabindex="-1"></a>initial.values <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">list</span>(<span class="at">theta =</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb34-4"><a href="1.4-functions-in-nimble.html#cb34-4" aria-hidden="true" tabindex="-1"></a>n.iter <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb34-5"><a href="1.4-functions-in-nimble.html#cb34-5" aria-hidden="true" tabindex="-1"></a>n.burnin <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb34-6"><a href="1.4-functions-in-nimble.html#cb34-6" aria-hidden="true" tabindex="-1"></a>n.chains <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb34-7"><a href="1.4-functions-in-nimble.html#cb34-7" aria-hidden="true" tabindex="-1"></a>mcmc.output <span class="ot">&lt;-</span> <span class="fu">nimbleMCMC</span>(<span class="at">code =</span> model,</span>
<span id="cb34-8"><a href="1.4-functions-in-nimble.html#cb34-8" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> my.data,</span>
<span id="cb34-9"><a href="1.4-functions-in-nimble.html#cb34-9" aria-hidden="true" tabindex="-1"></a>                          <span class="at">inits =</span> initial.values,</span>
<span id="cb34-10"><a href="1.4-functions-in-nimble.html#cb34-10" aria-hidden="true" tabindex="-1"></a>                          <span class="at">monitors =</span> parameters.to.save,</span>
<span id="cb34-11"><a href="1.4-functions-in-nimble.html#cb34-11" aria-hidden="true" tabindex="-1"></a>                          <span class="at">niter =</span> n.iter,</span>
<span id="cb34-12"><a href="1.4-functions-in-nimble.html#cb34-12" aria-hidden="true" tabindex="-1"></a>                          <span class="at">nburnin =</span> n.burnin,</span>
<span id="cb34-13"><a href="1.4-functions-in-nimble.html#cb34-13" aria-hidden="true" tabindex="-1"></a>                          <span class="at">nchains =</span> n.chains)</span>
<span id="cb34-14"><a href="1.4-functions-in-nimble.html#cb34-14" aria-hidden="true" tabindex="-1"></a><span class="do">## |-------------|-------------|-------------|-------------|</span></span>
<span id="cb34-15"><a href="1.4-functions-in-nimble.html#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="do">## |-------------------------------------------------------|</span></span>
<span id="cb34-16"><a href="1.4-functions-in-nimble.html#cb34-16" aria-hidden="true" tabindex="-1"></a><span class="do">## |-------------|-------------|-------------|-------------|</span></span>
<span id="cb34-17"><a href="1.4-functions-in-nimble.html#cb34-17" aria-hidden="true" tabindex="-1"></a><span class="do">## |-------------------------------------------------------|</span></span>
<span id="cb34-18"><a href="1.4-functions-in-nimble.html#cb34-18" aria-hidden="true" tabindex="-1"></a><span class="do">## |-------------|-------------|-------------|-------------|</span></span>
<span id="cb34-19"><a href="1.4-functions-in-nimble.html#cb34-19" aria-hidden="true" tabindex="-1"></a><span class="do">## |-------------------------------------------------------|</span></span>
<span id="cb34-20"><a href="1.4-functions-in-nimble.html#cb34-20" aria-hidden="true" tabindex="-1"></a><span class="fu">MCMCsummary</span>(<span class="at">object =</span> mcmc.output, <span class="at">round =</span> <span class="dv">2</span>)</span>
<span id="cb34-21"><a href="1.4-functions-in-nimble.html#cb34-21" aria-hidden="true" tabindex="-1"></a><span class="do">##          mean   sd 2.5%  50% 97.5% Rhat n.eff</span></span>
<span id="cb34-22"><a href="1.4-functions-in-nimble.html#cb34-22" aria-hidden="true" tabindex="-1"></a><span class="do">## lifespan 0.94 0.16 0.66 0.92  1.29    1  2771</span></span>
<span id="cb34-23"><a href="1.4-functions-in-nimble.html#cb34-23" aria-hidden="true" tabindex="-1"></a><span class="do">## theta    0.34 0.06 0.22 0.34  0.46    1  2788</span></span></code></pre></div>
<p>Evaluating an R function from within NIMBLE slows MCMC sampling down, but if you can live with it, the cost is easily offset by the convenience of being able to use existing R functions.</p>
<p>Another advantage of using <code>nimbleRcall()</code> (or <code>nimbleExternalCall()</code>) is that you can keep large objects out of your model, so that NIMBLE does not have to handle them in MCMC sampling. These objects should be constants and not change when you run NIMBLE. Letting R manipulating these objects will save you time, usually more than the time you lose by calling R from within NIMBLE.</p>
</div>
<div id="user-defined-distributions" class="section level3" number="1.4.3">
<h3><span class="header-section-number">1.4.3</span> User-defined distributions</h3>
<p>With <code>nimbleFunctions</code> you can provide user-defined distributions to NIMBLE. You need to write functions for density (<code>d</code>) and simulation (<code>r</code>) for your distribution. As an example, we write our own binomial distribution:</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="1.4-functions-in-nimble.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># density</span></span>
<span id="cb35-2"><a href="1.4-functions-in-nimble.html#cb35-2" aria-hidden="true" tabindex="-1"></a>dmybinom <span class="ot">&lt;-</span> <span class="fu">nimbleFunction</span>(</span>
<span id="cb35-3"><a href="1.4-functions-in-nimble.html#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">run =</span> <span class="cf">function</span>(<span class="at">x =</span> <span class="fu">double</span>(<span class="dv">0</span>), </span>
<span id="cb35-4"><a href="1.4-functions-in-nimble.html#cb35-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="fu">double</span>(<span class="dv">0</span>), </span>
<span id="cb35-5"><a href="1.4-functions-in-nimble.html#cb35-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prob =</span> <span class="fu">double</span>(<span class="dv">0</span>), </span>
<span id="cb35-6"><a href="1.4-functions-in-nimble.html#cb35-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">log =</span> <span class="fu">integer</span>(<span class="dv">0</span>, <span class="at">default =</span> <span class="dv">1</span>)) {</span>
<span id="cb35-7"><a href="1.4-functions-in-nimble.html#cb35-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">returnType</span>(<span class="fu">double</span>(<span class="dv">0</span>))</span>
<span id="cb35-8"><a href="1.4-functions-in-nimble.html#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># compute binomial coefficient </span></span>
<span id="cb35-9"><a href="1.4-functions-in-nimble.html#cb35-9" aria-hidden="true" tabindex="-1"></a>    lchoose <span class="ot">&lt;-</span> <span class="fu">lfactorial</span>(size) <span class="sc">-</span> <span class="fu">lfactorial</span>(x) <span class="sc">-</span> <span class="fu">lfactorial</span>(size <span class="sc">-</span> x)</span>
<span id="cb35-10"><a href="1.4-functions-in-nimble.html#cb35-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># binomial density function</span></span>
<span id="cb35-11"><a href="1.4-functions-in-nimble.html#cb35-11" aria-hidden="true" tabindex="-1"></a>    logProb <span class="ot">&lt;-</span> lchoose <span class="sc">+</span> x <span class="sc">*</span> <span class="fu">log</span>(prob) <span class="sc">+</span> (size <span class="sc">-</span> x) <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> prob)</span>
<span id="cb35-12"><a href="1.4-functions-in-nimble.html#cb35-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(log) <span class="fu">return</span>(logProb)</span>
<span id="cb35-13"><a href="1.4-functions-in-nimble.html#cb35-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="fu">return</span>(<span class="fu">exp</span>(logProb)) </span>
<span id="cb35-14"><a href="1.4-functions-in-nimble.html#cb35-14" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb35-15"><a href="1.4-functions-in-nimble.html#cb35-15" aria-hidden="true" tabindex="-1"></a><span class="co"># simulation using the coin flip method (p. 524 in Devroye 1986)</span></span>
<span id="cb35-16"><a href="1.4-functions-in-nimble.html#cb35-16" aria-hidden="true" tabindex="-1"></a>rmybinom <span class="ot">&lt;-</span> <span class="fu">nimbleFunction</span>(</span>
<span id="cb35-17"><a href="1.4-functions-in-nimble.html#cb35-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">run =</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="fu">integer</span>(<span class="dv">0</span>, <span class="at">default =</span> <span class="dv">1</span>),</span>
<span id="cb35-18"><a href="1.4-functions-in-nimble.html#cb35-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">size =</span> <span class="fu">double</span>(<span class="dv">0</span>),</span>
<span id="cb35-19"><a href="1.4-functions-in-nimble.html#cb35-19" aria-hidden="true" tabindex="-1"></a>                 <span class="at">prob =</span> <span class="fu">double</span>(<span class="dv">0</span>)) {</span>
<span id="cb35-20"><a href="1.4-functions-in-nimble.html#cb35-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">returnType</span>(<span class="fu">double</span>(<span class="dv">0</span>))</span>
<span id="cb35-21"><a href="1.4-functions-in-nimble.html#cb35-21" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb35-22"><a href="1.4-functions-in-nimble.html#cb35-22" aria-hidden="true" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> size, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>)</span>
<span id="cb35-23"><a href="1.4-functions-in-nimble.html#cb35-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>size){</span>
<span id="cb35-24"><a href="1.4-functions-in-nimble.html#cb35-24" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (y[j] <span class="sc">&lt;</span> prob){</span>
<span id="cb35-25"><a href="1.4-functions-in-nimble.html#cb35-25" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> x <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb35-26"><a href="1.4-functions-in-nimble.html#cb35-26" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb35-27"><a href="1.4-functions-in-nimble.html#cb35-27" aria-hidden="true" tabindex="-1"></a>        x <span class="ot">&lt;-</span> x</span>
<span id="cb35-28"><a href="1.4-functions-in-nimble.html#cb35-28" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb35-29"><a href="1.4-functions-in-nimble.html#cb35-29" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb35-30"><a href="1.4-functions-in-nimble.html#cb35-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(x)    </span>
<span id="cb35-31"><a href="1.4-functions-in-nimble.html#cb35-31" aria-hidden="true" tabindex="-1"></a>  })</span></code></pre></div>
<p>You need to define the <code>nimbleFunctions</code> in R’s global environment for them to be accessed:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="1.4-functions-in-nimble.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">assign</span>(<span class="st">&#39;dmybinom&#39;</span>, dmybinom, .GlobalEnv)</span>
<span id="cb36-2"><a href="1.4-functions-in-nimble.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">assign</span>(<span class="st">&#39;rmybinom&#39;</span>, rmybinom, .GlobalEnv)</span></code></pre></div>
<p>You can try out your function and simulate a random value from a binomial distribution with size 5 and probability 0.1:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="1.4-functions-in-nimble.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rmybinom</span>(<span class="at">n =</span> <span class="dv">1</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">prob =</span> <span class="fl">0.1</span>)</span>
<span id="cb37-2"><a href="1.4-functions-in-nimble.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1</span></span></code></pre></div>
<p>All set. You can run your workflow:</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="1.4-functions-in-nimble.html#cb38-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">nimbleCode</span>({</span>
<span id="cb38-2"><a href="1.4-functions-in-nimble.html#cb38-2" aria-hidden="true" tabindex="-1"></a> <span class="co"># likelihood</span></span>
<span id="cb38-3"><a href="1.4-functions-in-nimble.html#cb38-3" aria-hidden="true" tabindex="-1"></a> survived <span class="sc">~</span> <span class="fu">dmybinom</span>(<span class="at">prob =</span> theta, <span class="at">size =</span> released)</span>
<span id="cb38-4"><a href="1.4-functions-in-nimble.html#cb38-4" aria-hidden="true" tabindex="-1"></a> <span class="co"># prior</span></span>
<span id="cb38-5"><a href="1.4-functions-in-nimble.html#cb38-5" aria-hidden="true" tabindex="-1"></a> theta <span class="sc">~</span> <span class="fu">dunif</span>(<span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb38-6"><a href="1.4-functions-in-nimble.html#cb38-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb38-7"><a href="1.4-functions-in-nimble.html#cb38-7" aria-hidden="true" tabindex="-1"></a>my.data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">released =</span> <span class="dv">57</span>, <span class="at">survived =</span> <span class="dv">19</span>)</span>
<span id="cb38-8"><a href="1.4-functions-in-nimble.html#cb38-8" aria-hidden="true" tabindex="-1"></a>initial.values <span class="ot">&lt;-</span> <span class="cf">function</span>() <span class="fu">list</span>(<span class="at">theta =</span> <span class="fu">runif</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb38-9"><a href="1.4-functions-in-nimble.html#cb38-9" aria-hidden="true" tabindex="-1"></a>n.iter <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb38-10"><a href="1.4-functions-in-nimble.html#cb38-10" aria-hidden="true" tabindex="-1"></a>n.burnin <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb38-11"><a href="1.4-functions-in-nimble.html#cb38-11" aria-hidden="true" tabindex="-1"></a>n.chains <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb38-12"><a href="1.4-functions-in-nimble.html#cb38-12" aria-hidden="true" tabindex="-1"></a>mcmc.output <span class="ot">&lt;-</span> <span class="fu">nimbleMCMC</span>(<span class="at">code =</span> model,</span>
<span id="cb38-13"><a href="1.4-functions-in-nimble.html#cb38-13" aria-hidden="true" tabindex="-1"></a> <span class="at">data =</span> my.data,</span>
<span id="cb38-14"><a href="1.4-functions-in-nimble.html#cb38-14" aria-hidden="true" tabindex="-1"></a> <span class="at">inits =</span> initial.values,</span>
<span id="cb38-15"><a href="1.4-functions-in-nimble.html#cb38-15" aria-hidden="true" tabindex="-1"></a> <span class="at">niter =</span> n.iter,</span>
<span id="cb38-16"><a href="1.4-functions-in-nimble.html#cb38-16" aria-hidden="true" tabindex="-1"></a> <span class="at">nburnin =</span> n.burnin,</span>
<span id="cb38-17"><a href="1.4-functions-in-nimble.html#cb38-17" aria-hidden="true" tabindex="-1"></a> <span class="at">nchains =</span> n.chains)</span>
<span id="cb38-18"><a href="1.4-functions-in-nimble.html#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="do">## |-------------|-------------|-------------|-------------|</span></span>
<span id="cb38-19"><a href="1.4-functions-in-nimble.html#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="do">## |-------------------------------------------------------|</span></span>
<span id="cb38-20"><a href="1.4-functions-in-nimble.html#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="do">## |-------------|-------------|-------------|-------------|</span></span>
<span id="cb38-21"><a href="1.4-functions-in-nimble.html#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="do">## |-------------------------------------------------------|</span></span>
<span id="cb38-22"><a href="1.4-functions-in-nimble.html#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="do">## |-------------|-------------|-------------|-------------|</span></span>
<span id="cb38-23"><a href="1.4-functions-in-nimble.html#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="do">## |-------------------------------------------------------|</span></span>
<span id="cb38-24"><a href="1.4-functions-in-nimble.html#cb38-24" aria-hidden="true" tabindex="-1"></a><span class="fu">MCMCsummary</span>(mcmc.output)</span>
<span id="cb38-25"><a href="1.4-functions-in-nimble.html#cb38-25" aria-hidden="true" tabindex="-1"></a><span class="do">##        mean      sd   2.5%    50%  97.5% Rhat n.eff</span></span>
<span id="cb38-26"><a href="1.4-functions-in-nimble.html#cb38-26" aria-hidden="true" tabindex="-1"></a><span class="do">## theta 0.338 0.06223 0.2261 0.3354 0.4642    1  2712</span></span></code></pre></div>
<p>Having <code>nimbleFunctions</code> offers infinite possibilities to customize your models and algorithms. Besides what we covered already, you can write your own samplers. We will see an example in a minute, but I first need to tell you more about the NIMBLE workflow.</p>
</div>
</div>
<p style="text-align: center;">
<a href="1.3-start-nimble.html"><button class="btn btn-default">Previous</button></a>
<a href="1.5-under-the-hood.html"><button class="btn btn-default">Next</button></a>
</p>
</div>
</div>


</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

</body>
</html>
